<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Camping & Budget Rooms Near Cairns — Ahana Hillside</title>
    <meta name="description" content="Book a campsite or budget room near Cairns, QLD. Eco-friendly camping and affordable accommodation in the tropical rainforest, close to the Great Barrier Reef. Check availability and book direct.">

    <!-- Open Graph -->
    <meta property="og:title" content="Book Camping & Budget Rooms Near Cairns — Ahana Hillside">
    <meta property="og:description" content="Eco-friendly campsites and budget rooms near Cairns. Tropical rainforest setting, close to the Great Barrier Reef. Book direct for best rates.">
    <meta property="og:url" content="https://ahanahillside.com/book">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://ahana-ical-proxy.ahanahillside.workers.dev/homepage-bg">
    <meta property="og:site_name" content="Ahana Hillside">
    <meta property="og:locale" content="en_AU">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Book Camping & Budget Rooms Near Cairns — Ahana Hillside">
    <meta name="twitter:description" content="Eco-friendly campsites and budget rooms near Cairns. Tropical rainforest setting, close to the Great Barrier Reef. Book direct for best rates.">
    <meta name="twitter:image" content="https://ahana-ical-proxy.ahanahillside.workers.dev/homepage-bg">

    <!-- SEO -->
    <link rel="canonical" href="https://ahanahillside.com/book">
    <meta name="geo.region" content="AU-QLD">
    <meta name="geo.placename" content="Aloomba, Queensland">
    <meta name="keywords" content="book campsite Cairns, camping near Cairns book online, budget room Cairns, cheap accommodation Cairns QLD, eco camping Queensland book, Cairns rainforest accommodation, Great Barrier Reef accommodation">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;1,400&family=DM+Sans:ital,wght@0,400;0,500;1,400&display=swap" rel="stylesheet">

    <style>
        :root {
            --color-stone: #A69583;
            --color-forest: #2C3E2D;
            --color-cream: #F3F1EC;
            --color-charcoal: #3D3D3D;
            --color-light-stone: #e8e0d8;

            --font-serif: 'Cormorant Garamond', Georgia, serif;
            --font-sans: 'DM Sans', -apple-system, sans-serif;
        }

        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-sans);
            background-color: var(--color-cream);
            color: var(--color-charcoal);
            line-height: 1.7;
            overflow-x: hidden;
            -ms-touch-action: manipulation;
            touch-action: manipulation;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 1.5rem 2rem 1rem;
            animation: fadeIn 0.6s ease-out;
        }

        .header a {
            text-decoration: none;
        }

        .header-logo-img {
            height: 70px;
            width: auto;
            filter: brightness(0) saturate(100%) invert(20%) sepia(9%) saturate(2184%) hue-rotate(81deg) brightness(96%) contrast(91%);
        }
        @media (max-width: 768px) {
            .header-logo-img {
                height: 50px;
            }
        }
        @media (max-width: 480px) {
            .header-logo-img {
                height: 40px;
            }
        }

        .back-link {
            display: inline-block;
            margin-top: 0.5rem;
            font-size: 0.8rem;
            color: var(--color-stone);
            text-decoration: none;
            letter-spacing: 0.05em;
            transition: color 0.2s ease;
        }

        .back-link:hover {
            color: var(--color-forest);
        }

        /* Page intro */
        .page-intro {
            text-align: center;
            padding: 2rem 2rem 1rem;
            max-width: 600px;
            margin: 0 auto;
            animation: fadeIn 0.6s ease-out 0.1s both;
        }

        .page-intro h1 {
            font-family: var(--font-serif);
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            font-weight: 500;
            color: var(--color-forest);
            margin-bottom: 0.5rem;
        }

        .page-intro p {
            font-family: var(--font-serif);
            font-style: italic;
            font-size: 1.05rem;
            color: var(--color-charcoal);
        }

        .divider {
            width: 60px;
            height: 1px;
            background-color: var(--color-stone);
            margin: 1.5rem auto 0;
        }

        /* Category toggle */
        .category-toggle {
            max-width: 600px;
            margin: 1.5rem auto 0;
            padding: 0 2rem;
            display: flex;
            gap: 1rem;
        }

        .category-btn {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.25rem 1.5rem;
            background: #fff;
            border: 1px solid var(--color-light-stone);
            cursor: pointer;
            transition: border-color 0.2s, background 0.2s;
            text-align: left;
        }

        .category-btn:hover {
            border-color: var(--color-stone);
        }

        .category-btn.active {
            border-color: var(--color-forest);
            background: rgba(44, 62, 45, 0.04);
        }

        .category-icon {
            width: 36px;
            height: 36px;
            flex-shrink: 0;
            color: var(--color-stone);
            transition: color 0.2s;
        }

        .category-btn.active .category-icon {
            color: var(--color-forest);
        }

        .category-text {
            display: flex;
            flex-direction: column;
        }

        .category-title {
            font-family: var(--font-serif);
            font-size: 1.15rem;
            font-weight: 500;
            color: var(--color-charcoal);
            line-height: 1.3;
        }

        .category-desc {
            font-size: 0.75rem;
            color: var(--color-stone);
            margin-top: 0.15rem;
        }

        @media (max-width: 480px) {
            .category-toggle {
                flex-direction: column;
                padding: 0 1.25rem;
                gap: 0.75rem;
            }
            .category-btn {
                padding: 1rem 1.25rem;
            }
        }

        /* Progress indicator */
        .progress-bar {
            max-width: 600px;
            margin: 0 auto;
            padding: 1.5rem 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.75rem;
            color: var(--color-stone);
            letter-spacing: 0.05em;
            white-space: nowrap;
        }

        .progress-step.active {
            color: var(--color-forest);
            font-weight: 500;
        }

        .progress-step.completed {
            color: var(--color-forest);
        }

        .progress-num {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 1px solid var(--color-stone);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
        }

        .progress-step.active .progress-num {
            background: var(--color-forest);
            border-color: var(--color-forest);
            color: #fff;
        }

        .progress-step.completed .progress-num {
            background: var(--color-forest);
            border-color: var(--color-forest);
            color: #fff;
        }

        .progress-line {
            width: 30px;
            height: 1px;
            background: var(--color-light-stone);
        }

        .progress-line.completed {
            background: var(--color-forest);
        }

        /* Search bar */
        .search-bar {
            max-width: 1100px;
            margin: 0 auto;
            padding: 1rem 2rem 0;
            animation: fadeIn 0.6s ease-out 0.15s both;
            position: relative;
            z-index: 10;
        }

        .search-bar-inner {
            display: flex;
            align-items: flex-end;
            gap: 1rem;
            background: #fff;
            border: 1px solid var(--color-light-stone);
            padding: 1.25rem 1.5rem;
        }

        .search-field {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.2rem;
        }

        .search-field label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--color-charcoal);
        }

        .search-field input,
        .search-field select {
            width: 100%;
            box-sizing: border-box;
            padding: 0.65rem 0.75rem;
            border: 1px solid var(--color-light-stone);
            background: #fff;
            font-family: var(--font-sans);
            font-size: 16px;
            color: var(--color-charcoal);
            outline: none;
            transition: border-color 0.2s ease;
        }

        .search-field input:focus,
        .search-field select:focus {
            border-color: var(--color-forest);
        }

        .search-field input::placeholder {
            color: var(--color-stone);
            opacity: 0.7;
        }

        .btn-primary {
            padding: 0.7rem 1.5rem;
            font-family: var(--font-sans);
            font-size: 0.85rem;
            font-weight: 500;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--color-cream);
            background-color: var(--color-forest);
            border: 1px solid var(--color-forest);
            cursor: pointer;
            white-space: nowrap;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .btn-primary:hover {
            background-color: transparent;
            color: var(--color-forest);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            padding: 0.7rem 1.5rem;
            font-family: var(--font-sans);
            font-size: 0.85rem;
            font-weight: 500;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--color-forest);
            background-color: transparent;
            border: 1px solid var(--color-forest);
            cursor: pointer;
            white-space: nowrap;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .btn-secondary:hover {
            background-color: var(--color-forest);
            color: var(--color-cream);
        }

        /* Steps container */
        .wizard-step {
            display: none;
        }

        .wizard-step.active {
            display: block;
        }

        /* Step 2: Campsites list */
        .campsites {
            max-width: 1100px;
            margin: 0 auto;
            padding: 2rem 2rem 4rem;
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        /* Individual campsite — horizontal card */
        .campsite {
            background: #fff;
            border: 1px solid var(--color-light-stone);
            display: grid;
            grid-template-columns: 2fr 3fr;
            animation: fadeIn 0.6s ease-out both;
            position: relative;
            overflow: hidden;
            transition: opacity 0.3s ease;
        }

        .campsite:nth-child(2) {
            animation-delay: 0.15s;
        }

        /* Grey-out when guests exceed max */
        .campsite.guest-exceeded {
            opacity: 0.4;
        }

        .campsite.guest-exceeded .btn-select {
            display: none !important;
        }

        .campsite.guest-exceeded .campsite-price {
            display: none !important;
        }

        .guest-message {
            display: none;
            text-align: center;
            padding: 1rem;
            background: #fef2f2;
            border: 1px solid #fecaca;
            font-size: 0.85rem;
            color: #b44;
            margin-top: auto;
        }

        .campsite.guest-exceeded .guest-message {
            display: block;
        }

        /* Campsite media (left) */
        .campsite-media {
            overflow: hidden;
        }

        /* Carousel */
        .campsite-media .carousel {
            position: relative;
            overflow: hidden;
            aspect-ratio: 5 / 4;
        }

        .carousel-track {
            display: flex;
            height: 100%;
            transition: transform 0.35s ease;
        }

        .carousel-slide {
            min-width: 100%;
            height: 100%;
            cursor: pointer;
            touch-action: manipulation;
        }

        .carousel-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .carousel-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.85);
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 1.05rem;
            color: var(--color-charcoal);
            cursor: pointer;
            z-index: 2;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s ease;
        }

        .carousel-btn:hover {
            background: #fff;
        }

        .carousel-btn-prev { left: 8px; }
        .carousel-btn-next { right: 8px; }

        .carousel-dots {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 6px;
            z-index: 2;
        }

        .carousel-dot {
            width: 7px;
            height: 7px;
            border-radius: 50%;
            background: rgba(255,255,255,0.5);
            border: none;
            cursor: pointer;
            padding: 0;
            transition: background 0.2s ease;
        }

        .carousel-dot.active {
            background: #fff;
        }

        .carousel-counter {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.45);
            color: #fff;
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 10px;
            z-index: 2;
            letter-spacing: 0.05em;
        }

        /* Lightbox */
        .lightbox {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 1000;
            background: rgba(0,0,0,0.92);
            align-items: center;
            justify-content: center;
            overflow: hidden;
            touch-action: none;
        }

        .lightbox.open {
            display: flex;
        }

        .lightbox-img {
            max-width: 90vw;
            max-height: 85vh;
            object-fit: contain;
            border-radius: 2px;
        }

        .lightbox-close {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            background: none;
            border: none;
            color: #fff;
            font-size: 2rem;
            cursor: pointer;
            line-height: 1;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }

        .lightbox-close:hover { opacity: 1; }

        .lightbox-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.15);
            border: none;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            font-size: 1.5rem;
            color: #fff;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .lightbox-btn:hover { background: rgba(255,255,255,0.3); }

        .lightbox-prev { left: 1.5rem; }
        .lightbox-next { right: 1.5rem; }

        .lightbox-counter {
            position: absolute;
            bottom: 1.5rem;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255,255,255,0.6);
            font-size: 0.85rem;
        }

        /* Campsite details (right) */
        .campsite-body {
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
        }

        .campsite-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.25rem;
        }

        .campsite-name {
            font-family: var(--font-serif);
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--color-forest);
            letter-spacing: 0.05em;
        }

        .max-badge {
            font-size: 0.65rem;
            font-weight: 500;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            padding: 0.2rem 0.6rem;
            background: var(--color-light-stone);
            color: var(--color-charcoal);
            border-radius: 2px;
            white-space: nowrap;
        }

        .campsite-type {
            font-size: 0.8rem;
            color: var(--color-stone);
            margin-bottom: 1rem;
            letter-spacing: 0.02em;
        }

        .campsite-description {
            font-size: 0.9rem;
            color: var(--color-charcoal);
            margin-bottom: 1.25rem;
            line-height: 1.6;
        }

        .campsite-amenities {
            display: flex;
            flex-wrap: wrap;
            gap: 0.35rem;
            margin-bottom: 0.75rem;
            font-size: 0.8rem;
            color: var(--color-charcoal);
        }

        .highlight-tag {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.3rem 0.65rem;
            border: 1px solid var(--color-light-stone);
            border-radius: 4px;
            font-size: 0.75rem;
            color: var(--color-charcoal);
            background: #fff;
            white-space: nowrap;
        }
        .highlight-tag svg {
            width: 14px;
            height: 14px;
            flex-shrink: 0;
            stroke: var(--color-stone);
            fill: none;
            stroke-width: 1.8;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .details-toggle {
            background: none;
            border: none;
            color: var(--color-forest);
            font-size: 0.8rem;
            cursor: pointer;
            padding: 0;
            margin-bottom: 0.75rem;
            font-family: var(--font-sans);
            display: block;
        }

        .details-toggle:hover {
            text-decoration: underline;
        }

        .campsite-details {
            border-top: 1px solid var(--color-light-stone);
            padding-top: 0.75rem;
            margin-bottom: 1rem;
        }

        .details-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem 1.5rem;
            margin-bottom: 0.75rem;
            font-size: 0.82rem;
            color: var(--color-charcoal);
        }

        .details-meta span {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
        }

        .details-meta strong {
            font-weight: 600;
        }

        .details-category {
            margin-bottom: 0.6rem;
        }

        .details-category h4 {
            font-size: 0.82rem;
            font-weight: 600;
            color: var(--color-charcoal);
            margin-bottom: 0.25rem;
        }

        .details-cat-items {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.25rem 1rem;
            font-size: 0.8rem;
            color: var(--color-charcoal);
        }

        .details-cat-items span {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
        }
        .details-cat-items span svg {
            width: 14px;
            height: 14px;
            flex-shrink: 0;
            stroke: var(--color-forest);
            fill: none;
            stroke-width: 1.8;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .campsite-price {
            font-size: 0.9rem;
            margin-bottom: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--color-light-stone);
            margin-top: auto;
        }

        .rate-plans {
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
            margin-bottom: 0.35rem;
        }

        .rate-plan {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.88rem;
            cursor: pointer;
            padding: 0.35rem 0.5rem;
            border: 1px solid transparent;
            border-radius: 4px;
            transition: border-color 0.2s, background 0.2s;
            flex-wrap: wrap;
        }
        .rate-plan:hover {
            background: rgba(44,62,45,0.03);
        }
        .rate-plan.rate-selected {
            border-color: var(--color-forest);
            background: rgba(44,62,45,0.04);
        }

        .rate-badge {
            display: inline-block;
            padding: 0.15rem 0.55rem;
            font-size: 0.68rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.04em;
            border-radius: 2px;
            white-space: nowrap;
        }

        .rate-badge-flexible {
            background: #E8F5E9;
            color: #2E7D32;
            border: 1px solid #C8E6C9;
        }

        .rate-badge-nonrefundable {
            background: #FFF3E0;
            color: #E65100;
            border: 1px solid #FFE0B2;
        }

        .rate-plan .rate-check {
            display: none;
            width: 16px;
            height: 16px;
            min-width: 16px;
            border-radius: 50%;
            border: 2px solid var(--color-forest);
            background: var(--color-forest);
            position: relative;
            flex-shrink: 0;
        }
        .rate-plan .rate-check::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #fff;
        }
        .rate-plan.rate-selected .rate-check {
            display: inline-block;
        }
        .rate-plan .rate-uncheck {
            display: inline-block;
            width: 16px;
            height: 16px;
            min-width: 16px;
            border-radius: 50%;
            border: 2px solid var(--color-light-stone);
            flex-shrink: 0;
        }
        .rate-plan.rate-selected .rate-uncheck {
            display: none;
        }

        /* T&C Modal */
        .tc-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.55);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }
        .tc-overlay.open {
            display: flex;
        }
        .tc-modal {
            background: #fff;
            width: 92%;
            max-width: 680px;
            max-height: 82vh;
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 8px 40px rgba(0,0,0,0.25);
        }
        .tc-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e5e0d8;
        }
        .tc-modal-header h3 {
            margin: 0;
            font-family: 'Playfair Display', serif;
            font-size: 1.2rem;
            color: var(--color-forest);
        }
        .tc-modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--color-stone);
            line-height: 1;
            padding: 0 0.25rem;
        }
        .tc-modal-close:hover { color: var(--color-forest); }
        .tc-modal-body {
            padding: 1.5rem;
            overflow-y: auto;
            font-size: 0.88rem;
            line-height: 1.7;
            color: #3a3a3a;
        }
        .tc-modal-body h4 {
            margin: 1.2rem 0 0.4rem;
            font-size: 0.95rem;
            color: var(--color-forest);
        }
        .tc-modal-body h4:first-child { margin-top: 0; }
        .tc-modal-body p {
            margin: 0 0 0.5rem;
        }
        .tc-modal-body ul {
            margin: 0 0 0.5rem;
            padding-left: 1.2rem;
        }
        .tc-modal-body ul li {
            margin-bottom: 0.25rem;
        }

        /* T&C agreement */
        .tc-agreement {
            display: flex;
            align-items: flex-start;
            gap: 0.6rem;
            margin: 1rem 0 0.5rem;
            padding: 0.75rem 1rem;
            background: #f9f7f3;
            border: 1px solid #e5e0d8;
            border-radius: 4px;
        }
        .tc-agreement input[type="checkbox"] {
            margin-top: 0.2rem;
            width: 16px;
            height: 16px;
            flex-shrink: 0;
            accent-color: var(--color-forest);
        }
        .tc-agreement label {
            font-size: 0.85rem;
            line-height: 1.5;
            color: #3a3a3a;
            cursor: pointer;
        }
        .tc-agreement label a {
            color: var(--color-forest);
            text-decoration: underline;
            cursor: pointer;
        }
        .tc-agreement label a:hover {
            color: #1a2e1b;
        }
        .tc-error {
            color: #c62828;
            font-size: 0.8rem;
            margin: 0 0 0.5rem 0;
            display: none;
        }

        .rate-price-group {
            display: inline-flex;
            align-items: baseline;
            gap: 0.25rem;
            white-space: nowrap;
        }

        .rate-plan strong {
            font-size: 1.1rem;
            color: var(--color-forest);
            white-space: nowrap;
        }

        .rate-plan .rate-per {
            font-size: 0.82rem;
            color: var(--color-charcoal);
            white-space: nowrap;
        }

        .rate-plan .rate-save {
            font-size: 0.7rem;
            color: #E65100;
            font-weight: 500;
            white-space: nowrap;
        }

        @media (max-width: 480px) {
            .rate-plan {
                gap: 0.3rem;
                padding: 0.4rem 0.4rem;
                font-size: 0.82rem;
            }
            .rate-plan strong {
                font-size: 0.95rem;
            }
            .rate-badge {
                font-size: 0.6rem;
                padding: 0.1rem 0.4rem;
            }
            .rate-plan .rate-per {
                font-size: 0.75rem;
            }
            .rate-plan .rate-save {
                font-size: 0.65rem;
            }
        }

        .campsite-price .price-note {
            font-size: 0.75rem;
            color: var(--color-stone);
        }

        /* Price breakdown mini */
        .price-breakdown-mini {
            font-size: 0.8rem;
            background: #fff;
            padding: 0.75rem;
            margin-bottom: 1rem;
        }

        .price-breakdown-mini .price-line {
            display: flex;
            justify-content: space-between;
            padding: 0.15rem 0;
            color: var(--color-charcoal);
        }

        .price-breakdown-mini .price-line.total {
            font-weight: 500;
            color: var(--color-forest);
            border-top: 1px solid var(--color-light-stone);
            margin-top: 0.3rem;
            padding-top: 0.4rem;
        }


        .btn-select {
            display: block;
            width: 100%;
            padding: 0.75rem;
            font-family: var(--font-sans);
            font-size: 0.85rem;
            font-weight: 500;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--color-cream);
            background-color: var(--color-forest);
            border: 1px solid var(--color-forest);
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .btn-select:hover {
            background-color: transparent;
            color: var(--color-forest);
        }

        .btn-select:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .date-warning {
            display: none;
            font-size: 0.8rem;
            color: #b44;
            padding: 0.5rem 0.65rem;
            background: #fef2f2;
            border: 1px solid #fecaca;
            margin-bottom: 0.5rem;
        }

        .date-warning.show {
            display: block;
        }

        /* Step 3: Add-ons */
        .step-content {
            max-width: 700px;
            margin: 0 auto;
            padding: 2rem;
        }

        .step-title {
            font-family: var(--font-serif);
            font-size: 1.5rem;
            font-weight: 500;
            color: var(--color-forest);
            margin-bottom: 0.5rem;
            text-align: center;
        }

        .step-subtitle {
            font-size: 0.9rem;
            color: var(--color-stone);
            text-align: center;
            margin-bottom: 2rem;
        }

        .addon-card {
            background: #fff;
            border: 1px solid var(--color-light-stone);
            padding: 1.25rem;
            margin-bottom: 1rem;
        }

        .addon-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }

        .addon-name {
            font-weight: 500;
            color: var(--color-forest);
            font-size: 1rem;
        }

        .addon-price {
            font-weight: 500;
            color: var(--color-forest);
        }

        .addon-desc {
            font-size: 0.85rem;
            color: var(--color-charcoal);
            margin-bottom: 0.75rem;
        }

        .addon-note {
            font-size: 0.75rem;
            color: var(--color-stone);
            font-style: italic;
            margin-bottom: 0.75rem;
        }

        .addon-qty {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .addon-qty label {
            font-size: 0.8rem;
            color: var(--color-stone);
        }

        .qty-control {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .qty-btn {
            width: 32px;
            height: 32px;
            border: 1px solid var(--color-light-stone);
            background: #fff;
            font-size: 1.1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: border-color 0.2s;
        }

        .qty-btn:hover {
            border-color: var(--color-forest);
        }

        .qty-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .qty-value {
            width: 40px;
            text-align: center;
            font-weight: 500;
        }

        /* Summary box */
        .summary-box {
            background: #fff;
            border: 1px solid var(--color-light-stone);
            padding: 1.25rem;
            margin-top: 2rem;
        }

        .summary-title {
            font-family: var(--font-serif);
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--color-forest);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--color-light-stone);
        }

        .summary-line {
            display: flex;
            justify-content: space-between;
            padding: 0.3rem 0;
            font-size: 0.9rem;
        }

        .summary-line.total {
            font-weight: 600;
            color: var(--color-forest);
            font-size: 1rem;
            border-top: 1px solid var(--color-light-stone);
            margin-top: 0.5rem;
            padding-top: 0.75rem;
        }

        .summary-line.discount {
            color: #5a9a5a;
        }

        /* Step navigation */
        .step-nav {
            display: flex;
            justify-content: space-between;
            gap: 1rem;
            margin-top: 2rem;
        }

        .step-nav .btn-secondary {
            flex: 0 0 auto;
        }

        .step-nav .btn-primary {
            flex: 1;
            max-width: 250px;
        }

        /* Step 4: Details form */
        .details-form {
            background: #fff;
            border: 1px solid var(--color-light-stone);
            padding: 1.5rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .form-field {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }

        .form-field.full-width {
            grid-column: 1 / -1;
        }

        .form-field label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--color-charcoal);
        }

        .form-field input {
            padding: 0.75rem;
            border: 1px solid var(--color-light-stone);
            background: #fff;
            font-family: var(--font-sans);
            font-size: 16px;
            color: var(--color-charcoal);
            outline: none;
            transition: border-color 0.2s ease;
        }

        .form-field input::placeholder {
            color: var(--color-stone);
            opacity: 0.7;
        }

        .form-field input:focus {
            border-color: var(--color-forest);
        }

        .promo-row {
            display: flex;
            gap: 0.5rem;
        }

        .promo-row input {
            flex: 1;
            text-transform: uppercase;
        }

        .promo-apply {
            padding: 0.75rem 1rem;
            font-family: var(--font-sans);
            font-size: 0.75rem;
            font-weight: 500;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            border: 1px solid var(--color-forest);
            background: transparent;
            color: var(--color-forest);
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
        }

        .promo-apply:hover {
            background: var(--color-forest);
            color: var(--color-cream);
        }

        .promo-msg {
            font-size: 0.75rem;
            margin-top: 0.25rem;
        }

        .promo-msg.valid { color: #5a9a5a; }
        .promo-msg.invalid { color: #b44; }

        /* Step 5: Review */
        .review-card {
            background: #fff;
            border: 1px solid var(--color-light-stone);
            padding: 1.5rem;
        }

        .review-section {
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--color-light-stone);
        }

        .review-section:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .review-section-title {
            font-family: var(--font-serif);
            font-size: 1rem;
            font-weight: 500;
            color: var(--color-forest);
            margin-bottom: 0.75rem;
        }

        .review-row {
            display: flex;
            justify-content: space-between;
            padding: 0.25rem 0;
            font-size: 0.9rem;
        }

        .review-row .label {
            color: var(--color-stone);
        }

        /* Custom date picker */
        .date-picker-wrapper {
            position: relative;
        }

        .dp-input {
            cursor: pointer !important;
            background: #fff url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23A69583' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='4' width='18' height='18' rx='2' ry='2'/%3E%3Cline x1='16' y1='2' x2='16' y2='6'/%3E%3Cline x1='8' y1='2' x2='8' y2='6'/%3E%3Cline x1='3' y1='10' x2='21' y2='10'/%3E%3C/svg%3E") no-repeat right 8px center !important;
            padding-right: 2rem !important;
        }

        .dp-dropdown {
            display: none;
            position: absolute;
            top: calc(100% + 4px);
            left: 0;
            z-index: 50;
            background: #fff;
            border: 1px solid var(--color-light-stone);
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
            padding: 0.75rem;
            width: 260px;
        }

        .dp-dropdown.open { display: block; }

        .dp-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .dp-arrow {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            padding: 0.2rem 0.5rem;
            color: var(--color-charcoal);
            line-height: 1;
        }

        .dp-arrow:hover { color: var(--color-forest); }

        .dp-month-label {
            font-family: var(--font-serif);
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--color-forest);
        }

        .dp-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
        }

        .dp-header {
            text-align: center;
            font-size: 0.6rem;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            color: var(--color-stone);
            padding: 0.25rem 0;
        }

        .dp-day {
            text-align: center;
            padding: 0.35rem 0;
            font-size: 0.78rem;
            cursor: pointer;
            border-radius: 2px;
            transition: background 0.15s;
            position: relative;
            line-height: 1.4;
        }

        .dp-day:hover:not(.dp-empty):not(.dp-past):not(.dp-blocked) {
            background: var(--color-light-stone);
        }

        .dp-day.dp-empty { cursor: default; }

        .dp-day.dp-past {
            color: #ccc;
            cursor: default;
        }

        .dp-day.dp-today {
            font-weight: 600;
            box-shadow: inset 0 0 0 1px var(--color-forest);
        }

        .dp-day.dp-blocked {
            color: #c0392b;
            cursor: not-allowed;
            background: #fef2f2;
        }

        .dp-day.dp-blocked::after {
            content: '\00d7';
            position: absolute;
            top: -1px;
            right: 2px;
            font-size: 0.55rem;
            color: #c0392b;
            font-weight: bold;
            line-height: 1;
        }

        .dp-day.dp-limited {
            color: #b87a00;
            background: #fef9e7;
            position: relative;
        }
        .dp-day.dp-limited::after {
            content: '';
            position: absolute;
            bottom: 2px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: #d4a017;
        }

        .dp-day.dp-selected {
            background: var(--color-forest);
            color: #fff !important;
        }

        .dp-day.dp-selected.dp-today { box-shadow: none; }

        .dp-day.dp-in-range {
            background: rgba(44, 62, 45, 0.08);
        }

        .dp-legend {
            display: flex;
            gap: 0.75rem;
            justify-content: center;
            margin-top: 0.5rem;
            font-size: 0.65rem;
            color: var(--color-stone);
        }
        .dp-legend-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        .dp-legend-dot {
            width: 7px;
            height: 7px;
            border-radius: 50%;
            display: inline-block;
        }

        .dp-footer {
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
            padding-top: 0.4rem;
            border-top: 1px solid var(--color-light-stone);
            font-size: 0.75rem;
        }

        .dp-footer a {
            color: var(--color-stone);
            text-decoration: none;
            cursor: pointer;
            transition: color 0.2s;
        }

        .dp-footer a:hover { color: var(--color-forest); }

        /* Rules section */
        .rules {
            max-width: 600px;
            margin: 0 auto;
            padding: 0 2rem 4rem;
            text-align: center;
            animation: fadeIn 0.6s ease-out 0.3s both;
        }

        .rules h2 {
            font-family: var(--font-serif);
            font-size: 1.3rem;
            font-weight: 500;
            color: var(--color-forest);
            margin-bottom: 1rem;
        }

        .rules ul {
            list-style: none;
            font-size: 0.85rem;
            color: var(--color-charcoal);
        }

        .rules li {
            padding: 0.4rem 0;
            border-bottom: 1px solid var(--color-light-stone);
        }

        .rules li:last-child {
            border-bottom: none;
        }

        /* Guest Reviews */
        .reviews-strip {
            background: #fff;
            border-top: 1px solid var(--color-light-stone);
            padding: 2.5rem 1.5rem;
            text-align: center;
            display: none;
        }
        .reviews-strip-title {
            font-family: var(--font-serif);
            font-size: 1.3rem;
            font-weight: 400;
            color: var(--color-forest);
            margin-bottom: 1.5rem;
        }
        .reviews-strip-title em { font-style: italic; }
        .reviews-scroll {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            padding-bottom: 0.5rem;
            max-width: 900px;
            margin: 0 auto;
        }
        .reviews-scroll::-webkit-scrollbar { height: 4px; }
        .reviews-scroll::-webkit-scrollbar-track { background: transparent; }
        .reviews-scroll::-webkit-scrollbar-thumb { background: var(--color-light-stone); border-radius: 2px; }
        .review-mini {
            scroll-snap-align: start;
            min-width: 280px;
            max-width: 320px;
            background: var(--color-cream);
            border: 1px solid var(--color-light-stone);
            padding: 1.25rem;
            text-align: left;
            flex-shrink: 0;
        }
        .review-mini-top {
            display: flex;
            align-items: flex-start;
            gap: 0.6rem;
            margin-bottom: 0.5rem;
        }
        .review-mini-score {
            flex-shrink: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: 700;
            font-size: 0.8rem;
            border-radius: 5px 5px 5px 0;
        }
        .review-mini-info { flex: 1; }
        .review-mini-name {
            font-family: var(--font-serif);
            font-size: 1rem;
            font-weight: 500;
            color: var(--color-forest);
        }
        .review-mini-country {
            font-size: 0.7rem;
            color: var(--color-stone);
            margin-left: 0.2rem;
        }
        .review-mini-badge {
            font-size: 0.55rem;
            padding: 0.12rem 0.35rem;
            border-radius: 3px;
            color: #fff;
            margin-left: 0.3rem;
        }
        .review-mini-title {
            font-size: 0.82rem;
            font-weight: 500;
            color: var(--color-charcoal);
            margin-bottom: 0.3rem;
        }
        .review-mini-liked {
            font-size: 0.8rem;
            color: var(--color-charcoal);
            line-height: 1.55;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .review-mini-liked .rm-icon { color: #3D7A3D; margin-right: 0.3rem; }

        /* Footer */
        .footer {
            text-align: center;
            padding: 2rem;
            font-size: 0.75rem;
            color: var(--color-stone);
            letter-spacing: 0.05em;
        }

        .footer a {
            color: var(--color-stone);
            text-decoration: none;
            transition: color 0.2s;
        }

        .footer a:hover { color: var(--color-forest); }

        .footer-links {
            margin-bottom: 0.5rem;
        }

        .footer-links a { margin: 0 0.75rem; }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .search-bar-inner {
                flex-direction: column;
                align-items: stretch;
            }

            .progress-bar {
                padding: 1rem;
            }

            .progress-step span:not(.progress-num) {
                display: none;
            }

            .campsites {
                padding: 2rem 1.25rem 3rem;
            }

            .campsite {
                grid-template-columns: 1fr;
            }

            .campsite-media .carousel {
                aspect-ratio: 4 / 3;
            }

            .details-cat-items {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .dp-dropdown {
                width: calc(100vw - 4rem);
                max-width: 260px;
            }

            .step-content {
                padding: 1.5rem 1.25rem;
            }

            .step-nav {
                flex-direction: column-reverse;
            }

            .step-nav .btn-primary {
                max-width: none;
            }

            .carousel-btn {
                width: 44px;
                height: 44px;
                font-size: 1.1rem;
            }

            .lightbox-btn {
                width: 44px;
                height: 44px;
                font-size: 1.3rem;
            }

            .lightbox-prev { left: 0.75rem; }
            .lightbox-next { right: 0.75rem; }
        }

        /* --- Camping Experience Section --- */
        .camp-experience {
            position: relative;
            margin: 1.5rem 0 0;
            overflow: hidden;
            min-height: 580px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .camp-scene {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
        }
        .camp-scene svg {
            width: 100%;
            height: 100%;
            display: block;
        }
        .camp-scene img,
        .camp-scene video {
            filter: brightness(0.45);
        }

        /* Text overlay */
        .camp-overlay {
            position: relative;
            z-index: 2;
            max-width: 580px;
            padding: 2rem;
            text-align: center;
        }
        .camp-text-label {
            font-size: 0.66rem;
            font-weight: 500;
            letter-spacing: 0.14em;
            text-transform: uppercase;
            color: rgba(255,255,255,0.7);
            margin-bottom: 0.5rem;
        }
        .camp-overlay h2 {
            font-family: var(--font-serif);
            font-size: clamp(1.6rem, 3.5vw, 2.2rem);
            font-weight: 500;
            color: #fff;
            line-height: 1.25;
            margin-bottom: 1rem;
        }
        .camp-overlay p {
            font-size: 0.86rem;
            line-height: 1.9;
            color: rgba(255,255,255,0.85);
            margin-bottom: 1.25rem;
        }
        .camp-benefits {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.6rem;
            margin-bottom: 1.75rem;
            text-align: left;
        }
        .camp-benefit {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }
        .camp-benefit-icon {
            width: 30px;
            height: 30px;
            min-width: 30px;
            background: rgba(255,255,255,0.12);
            border-radius: 7px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .camp-benefit-icon svg {
            width: 14px;
            height: 14px;
            stroke: rgba(255,255,255,0.8);
            fill: none;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        .camp-benefit span {
            font-size: 0.76rem;
            color: rgba(255,255,255,0.85);
            line-height: 1.4;
            padding-top: 0.3rem;
        }
        .camp-cta-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.8rem 1.8rem;
            font-family: var(--font-sans);
            font-size: 0.85rem;
            font-weight: 500;
            letter-spacing: 0.08em;
            color: var(--color-forest);
            background: #fff;
            border: 2px solid #fff;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }
        .camp-cta-btn:hover {
            background: transparent;
            color: #fff;
        }
        .camp-cta-btn svg {
            width: 16px;
            height: 16px;
            stroke: currentColor;
            fill: none;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            transition: transform 0.3s ease;
        }
        .camp-cta-btn:hover svg {
            transform: translateY(3px);
        }

        /* Camping section responsive */
        @media (max-width: 768px) {
            .camp-experience {
                min-height: 520px;
            }
            .camp-overlay {
                padding: 2rem 1.5rem;
                max-width: 100%;
            }
            .camp-benefits {
                grid-template-columns: 1fr;
                max-width: 260px;
                margin-left: auto;
                margin-right: auto;
            }
        }

        /* --- Hamburger Menu --- */
        .menu-btn {
            position: fixed;
            top: 1.25rem;
            right: 1.25rem;
            z-index: 1000;
            width: 44px;
            height: 44px;
            background: rgba(255,255,255,0.9);
            border: 1px solid var(--color-light-stone);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 5px;
            transition: background 0.3s;
            backdrop-filter: blur(4px);
        }
        .menu-btn:hover { background: #fff; }
        .menu-btn span {
            display: block;
            width: 18px;
            height: 2px;
            background: var(--color-forest);
            transition: transform 0.3s, opacity 0.3s;
        }
        .menu-btn.open span:nth-child(1) { transform: translateY(7px) rotate(45deg); }
        .menu-btn.open span:nth-child(2) { opacity: 0; }
        .menu-btn.open span:nth-child(3) { transform: translateY(-7px) rotate(-45deg); }
        .menu-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.3);
            z-index: 998; opacity: 0; visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        .menu-overlay.open { opacity: 1; visibility: visible; }
        .menu-panel {
            position: fixed; top: 0; right: -320px; width: 300px; max-width: 85vw;
            height: 100%; background: #fff; z-index: 999;
            transition: right 0.3s ease; display: flex; flex-direction: column;
            padding: 5rem 2rem 2rem;
        }
        .menu-panel.open { right: 0; }
        .menu-panel nav a {
            display: block; font-family: var(--font-serif); font-size: 1.4rem;
            font-weight: 500; color: var(--color-forest); text-decoration: none;
            padding: 0.75rem 0; border-bottom: 1px solid var(--color-light-stone);
            transition: color 0.2s, padding-left 0.2s;
        }
        .menu-panel nav a:hover { padding-left: 0.5rem; color: var(--color-stone); }
        .menu-panel nav a:last-child { border-bottom: none; }
        .menu-footer-nav { margin-top: auto; font-size: 0.75rem; color: var(--color-stone); line-height: 1.8; }
        .menu-footer-nav a { color: var(--color-stone); text-decoration: none; transition: color 0.2s; }
        .menu-footer-nav a:hover { color: var(--color-forest); }

    </style>

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Campground",
        "name": "Ahana Hillside",
        "description": "Eco-friendly campsites and budget-friendly rooms nestled in the Cairns tropical rainforest.",
        "url": "https://ahanahillside.com/book",
        "image": "https://ahana-ical-proxy.ahanahillside.workers.dev/homepage-bg",
        "address": {
            "@type": "PostalAddress",
            "streetAddress": "69863 Bruce Highway",
            "addressLocality": "Aloomba",
            "addressRegion": "QLD",
            "postalCode": "4871",
            "addressCountry": "AU"
        },
        "geo": {
            "@type": "GeoCoordinates",
            "latitude": -17.158221,
            "longitude": 145.862651
        },
        "containsPlace": [
            {
                "@type": "CampingPitch",
                "name": "Samavas",
                "description": "Family-friendly campsite with caravan access, campfire, and rainforest setting"
            },
            {
                "@type": "CampingPitch",
                "name": "Chhaya",
                "description": "Intimate campsite for couples with car parking and peaceful surroundings"
            }
        ],
        "amenityFeature": [
            { "@type": "LocationFeatureSpecification", "name": "Kitchen", "value": true },
            { "@type": "LocationFeatureSpecification", "name": "Campfire", "value": true },
            { "@type": "LocationFeatureSpecification", "name": "Free Parking", "value": true },
            { "@type": "LocationFeatureSpecification", "name": "Firewood Provided", "value": true }
        ],
        "numberOfRooms": 2,
        "priceRange": "$$",
        "currenciesAccepted": "AUD"
    }
    </script>
    <script defer src="/_vercel/insights/script.js"></script>
</head>
<body>
    <!-- Hamburger Menu -->
    <button class="menu-btn" onclick="toggleMenu()" aria-label="Open menu"><span></span><span></span><span></span></button>
    <div class="menu-overlay" onclick="toggleMenu()"></div>
    <div class="menu-panel">
        <nav>
            <a href="/">Home</a>
            <a href="/book">Book</a>
            <a href="/gallery">Gallery</a>
            <a href="/explore">Explore</a>
            <a href="/about">About Us</a>
            <a href="/events">Events</a>
            <a href="/contact">Contact</a>
        </nav>
        <div class="menu-footer-nav">
            <a href="/disclaimer">Disclaimer</a> &middot; <a href="/terms-and-conditions">Terms &amp; Conditions</a> &middot; <a href="/contact">Get in Touch</a><br>
            &copy; 2026 Ahana Hillside &middot; ABN: 731 5158 2872
        </div>
    </div>

    <div class="header">
        <a href="/">
            <img src="images/logo-white.png" alt="Ahana Hillside" class="header-logo-img">
        </a>
        <br>
        <a href="/" class="back-link">&larr; Back to home</a>
    </div>

    <div class="page-intro">
        <h1>Book Your Stay</h1>
        <p>Campsites and rooms nestled in the Cairns tropical rainforest</p>
        <div class="divider"></div>
    </div>

    <!-- Category Toggle -->
    <div class="category-toggle">
        <button class="category-btn active" data-category="rooms" onclick="switchCategory('rooms')">
            <svg class="category-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 21V7l9-4 9 4v14"/><path d="M9 21V11h6v10"/><rect x="10" y="13" width="4" height="3"/></svg>
            <div class="category-text">
                <span class="category-title">Rooms</span>
                <span class="category-desc">Budget-friendly private stays</span>
            </div>
        </button>
        <button class="category-btn" data-category="campsites" onclick="switchCategory('campsites')">
            <svg class="category-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L2 19h20L12 2z"/><path d="M12 19v3"/><path d="M7 19l5-10 5 10"/></svg>
            <div class="category-text">
                <span class="category-title">Campsites</span>
                <span class="category-desc">Camp under the stars</span>
            </div>
        </button>
    </div>

    <!-- Camping Experience Section -->
    <div class="camp-experience" style="display:none">
        <div class="camp-scene">
            <svg viewBox="0 0 1200 580" preserveAspectRatio="xMidYMid slice" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="nightSky" x1="0" y1="0" x2="0" y2="1">
                        <stop offset="0%" stop-color="#1a2a1c"/>
                        <stop offset="50%" stop-color="#2C3E2D"/>
                        <stop offset="100%" stop-color="#3a5040"/>
                    </linearGradient>
                    <radialGradient id="textDim" cx="600" cy="290" r="360" gradientUnits="userSpaceOnUse">
                        <stop offset="0%" stop-color="#1a2a1c" stop-opacity="0.8"/>
                        <stop offset="60%" stop-color="#1a2a1c" stop-opacity="0.4"/>
                        <stop offset="100%" stop-color="#1a2a1c" stop-opacity="0"/>
                    </radialGradient>
                </defs>

                <!-- Sky -->
                <rect width="1200" height="580" fill="url(#nightSky)"/>

                <!-- Stars -->
                <circle cx="80" cy="35" r="1.5" fill="#e8e0d8" opacity="0.55"/>
                <circle cx="200" cy="22" r="1" fill="#e8e0d8" opacity="0.4"/>
                <circle cx="340" cy="50" r="1.8" fill="#e8e0d8" opacity="0.5"/>
                <circle cx="480" cy="18" r="1.2" fill="#e8e0d8" opacity="0.45"/>
                <circle cx="600" cy="42" r="1.5" fill="#e8e0d8" opacity="0.35"/>
                <circle cx="720" cy="25" r="1" fill="#e8e0d8" opacity="0.5"/>
                <circle cx="860" cy="55" r="1.8" fill="#e8e0d8" opacity="0.45"/>
                <circle cx="1000" cy="30" r="1.3" fill="#e8e0d8" opacity="0.5"/>
                <circle cx="1120" cy="48" r="1" fill="#e8e0d8" opacity="0.35"/>
                <circle cx="150" cy="70" r="0.8" fill="#e8e0d8" opacity="0.3"/>
                <circle cx="420" cy="68" r="1.1" fill="#e8e0d8" opacity="0.35"/>
                <circle cx="780" cy="60" r="0.9" fill="#e8e0d8" opacity="0.3"/>
                <circle cx="950" cy="72" r="1" fill="#e8e0d8" opacity="0.25"/>
                <circle cx="540" cy="32" r="0.7" fill="#e8e0d8" opacity="0.3"/>
                <circle cx="660" cy="15" r="1.2" fill="#e8e0d8" opacity="0.4"/>

                <!-- Moon -->
                <circle cx="600" cy="75" r="26" fill="#e8e0d8" opacity="0.45"/>
                <circle cx="609" cy="69" r="23" fill="url(#nightSky)"/>

                <!-- Far mountains -->
                <path d="M0 250 Q100 190 220 230 Q340 180 450 215 Q560 175 680 210 Q780 170 900 205 Q1020 175 1120 200 L1200 220 L1200 320 L0 320Z" fill="#243428" opacity="0.55"/>
                <path d="M0 275 Q150 230 300 260 Q450 215 600 250 Q750 210 900 245 Q1050 220 1200 248 L1200 340 L0 340Z" fill="#2d4031" opacity="0.45"/>

                <!-- Tree line left -->
                <path d="M40 310 L55 248 L70 310Z" fill="#1f2f21" opacity="0.85"/>
                <path d="M65 310 L85 230 L105 310Z" fill="#1f2f21" opacity="0.95"/>
                <path d="M95 310 L112 252 L129 310Z" fill="#1f2f21" opacity="0.8"/>
                <path d="M125 310 L145 240 L165 310Z" fill="#1f2f21" opacity="0.9"/>

                <!-- Tree line right -->
                <path d="M1035 310 L1055 245 L1075 310Z" fill="#1f2f21" opacity="0.85"/>
                <path d="M1065 310 L1088 228 L1111 310Z" fill="#1f2f21" opacity="0.95"/>
                <path d="M1100 310 L1118 250 L1136 310Z" fill="#1f2f21" opacity="0.8"/>
                <path d="M1130 310 L1150 238 L1170 310Z" fill="#1f2f21" opacity="0.9"/>

                <!-- Ground -->
                <path d="M0 310 Q300 290 600 305 Q900 290 1200 310 L1200 580 L0 580Z" fill="#2a3e2c"/>
                <path d="M0 325 Q300 305 600 320 Q900 305 1200 325 L1200 580 L0 580Z" fill="#314435"/>

                <!-- Dirt path from left to right through camp -->
                <path d="M0 440 Q150 430 300 425 Q450 418 600 430 Q750 418 900 425 Q1050 430 1200 440" fill="none" stroke="#3e5442" stroke-width="18" stroke-linecap="round" opacity="0.4"/>
                <path d="M0 440 Q150 430 300 425 Q450 418 600 430 Q750 418 900 425 Q1050 430 1200 440" fill="none" stroke="#4a6248" stroke-width="8" stroke-linecap="round" opacity="0.2" stroke-dasharray="2 6"/>

                <!-- === LEFT SIDE: SAMAVAS === -->

                <!-- Caravan behind Samavas tent -->
                <rect x="310" y="370" width="76" height="36" rx="5" fill="#3a5040" stroke="#e8e0d8" stroke-width="1.2"/>
                <path d="M310 370 Q312 360 319 360 L378 360 Q386 360 386 370" fill="#3a5040" stroke="#e8e0d8" stroke-width="1.2"/>
                <!-- Caravan window -->
                <rect x="334" y="375" width="14" height="10" rx="2" fill="#2a3e2c" stroke="#e8e0d8" stroke-width="0.8" opacity="0.7"/>
                <!-- Caravan door -->
                <rect x="354" y="376" width="10" height="20" rx="1.5" fill="#2a3e2c" stroke="#e8e0d8" stroke-width="0.8" opacity="0.6"/>
                <circle cx="361" cy="386" r="1" fill="#e8e0d8" opacity="0.4"/>
                <!-- Caravan stripe -->
                <line x1="314" y1="392" x2="384" y2="392" stroke="#e8e0d8" stroke-width="0.5" opacity="0.2"/>
                <!-- Caravan wheels -->
                <circle cx="328" cy="410" r="5" fill="#2a3e2c" stroke="#e8e0d8" stroke-width="1.2"/>
                <circle cx="328" cy="410" r="2" fill="#e8e0d8" opacity="0.2"/>
                <circle cx="372" cy="410" r="5" fill="#2a3e2c" stroke="#e8e0d8" stroke-width="1.2"/>
                <circle cx="372" cy="410" r="2" fill="#e8e0d8" opacity="0.2"/>
                <!-- A-frame hitch -->
                <path d="M310 397 L298 408 M310 401 L298 408" stroke="#e8e0d8" stroke-width="1.2" stroke-linecap="round" opacity="0.4"/>
                <!-- Caravan awning light -->
                <circle cx="350" cy="362" r="1.5" fill="#e8c06a" opacity="0.25"/>

                <!-- Samavas tent -->
                <path d="M200 420 L260 330 L320 420Z" fill="#3a5040" stroke="#e8e0d8" stroke-width="1.8" stroke-linejoin="round"/>
                <path d="M230 420 L260 370 L290 420" fill="#2a3e2c" stroke="#e8e0d8" stroke-width="0.8" opacity="0.5"/>
                <line x1="260" y1="330" x2="260" y2="420" stroke="#e8e0d8" stroke-width="0.6" stroke-dasharray="3 4" opacity="0.2"/>
                <!-- Tent flag -->
                <path d="M260 330 L272 335 L260 340" fill="#e8a44a" opacity="0.4"/>

                <!-- Samavas wooden sign post -->
                <line x1="155" y1="350" x2="155" y2="420" stroke="#6b4a2e" stroke-width="4" stroke-linecap="round"/>
                <!-- Sign board -->
                <rect x="130" y="352" width="62" height="22" rx="3" fill="#7a5533" stroke="#5a3a20" stroke-width="1"/>
                <rect x="132" y="354" width="58" height="18" rx="2" fill="#8a6340"/>
                <text x="161" y="367" font-family="'Cormorant Garamond', serif" font-size="11" font-weight="500" fill="#f0e8de" text-anchor="middle" letter-spacing="1">Samavas</text>
                <!-- Sign nail dots -->
                <circle cx="137" cy="363" r="1.2" fill="#5a3a20" opacity="0.6"/>
                <circle cx="185" cy="363" r="1.2" fill="#5a3a20" opacity="0.6"/>
                <!-- Arrow on post -->
                <path d="M143 378 L155 385 L143 392" fill="none" stroke="#e8e0d8" stroke-width="0.8" opacity="0.3"/>

                <!-- Samavas lantern -->
                <rect x="196" y="405" width="5" height="8" rx="1" fill="none" stroke="#e8e0d8" stroke-width="0.8" opacity="0.5"/>
                <circle cx="198.5" cy="409" r="1.5" fill="#e8c06a" opacity="0.4"/>
                <line x1="198.5" y1="405" x2="198.5" y2="401" stroke="#e8e0d8" stroke-width="0.6" opacity="0.4"/>

                <!-- Backpack near Samavas -->
                <rect x="325" y="408" width="10" height="14" rx="3" fill="none" stroke="#e8e0d8" stroke-width="1" opacity="0.35"/>
                <line x1="325" y1="412" x2="335" y2="412" stroke="#e8e0d8" stroke-width="0.6" opacity="0.25"/>

                <!-- === RIGHT SIDE: CHHAYA === -->

                <!-- Small car behind Chhaya tent -->
                <rect x="870" y="392" width="52" height="16" rx="3.5" fill="#3a5040" stroke="#e8e0d8" stroke-width="1.1"/>
                <path d="M879 392 L884 381 L910 381 L915 392" fill="#3a5040" stroke="#e8e0d8" stroke-width="1.1"/>
                <!-- Car windows -->
                <path d="M886 383 L882 390 L896 390 L896 383Z" fill="#2a3e2c" stroke="#e8e0d8" stroke-width="0.6" opacity="0.6"/>
                <path d="M898 383 L898 390 L911 390 L908 383Z" fill="#2a3e2c" stroke="#e8e0d8" stroke-width="0.6" opacity="0.6"/>
                <!-- Car wheels -->
                <circle cx="882" cy="410" r="4" fill="#2a3e2c" stroke="#e8e0d8" stroke-width="1.1"/>
                <circle cx="882" cy="410" r="1.5" fill="#e8e0d8" opacity="0.2"/>
                <circle cx="912" cy="410" r="4" fill="#2a3e2c" stroke="#e8e0d8" stroke-width="1.1"/>
                <circle cx="912" cy="410" r="1.5" fill="#e8e0d8" opacity="0.2"/>
                <!-- Headlight -->
                <circle cx="922" cy="398" r="1.5" fill="#e8c06a" opacity="0.2"/>

                <!-- Chhaya tent (smaller) -->
                <path d="M910 420 L950 355 L990 420Z" fill="#3a5040" stroke="#e8e0d8" stroke-width="1.6" stroke-linejoin="round"/>
                <path d="M928 420 L950 385 L972 420" fill="#2a3e2c" stroke="#e8e0d8" stroke-width="0.7" opacity="0.5"/>
                <line x1="950" y1="355" x2="950" y2="420" stroke="#e8e0d8" stroke-width="0.5" stroke-dasharray="3 4" opacity="0.2"/>
                <!-- Tent flag -->
                <path d="M950 355 L938 360 L950 365" fill="#e8a44a" opacity="0.4"/>

                <!-- Chhaya wooden sign post -->
                <line x1="1030" y1="360" x2="1030" y2="420" stroke="#6b4a2e" stroke-width="4" stroke-linecap="round"/>
                <!-- Sign board -->
                <rect x="1005" y="362" width="62" height="22" rx="3" fill="#7a5533" stroke="#5a3a20" stroke-width="1"/>
                <rect x="1007" y="364" width="58" height="18" rx="2" fill="#8a6340"/>
                <text x="1036" y="377" font-family="'Cormorant Garamond', serif" font-size="11" font-weight="500" fill="#f0e8de" text-anchor="middle" letter-spacing="1">Chhaya</text>
                <!-- Sign nail dots -->
                <circle cx="1012" cy="373" r="1.2" fill="#5a3a20" opacity="0.6"/>
                <circle cx="1060" cy="373" r="1.2" fill="#5a3a20" opacity="0.6"/>
                <!-- Arrow on post -->
                <path d="M1042 388 L1030 395 L1042 402" fill="none" stroke="#e8e0d8" stroke-width="0.8" opacity="0.3"/>

                <!-- Chhaya lantern -->
                <rect x="996" y="408" width="5" height="8" rx="1" fill="none" stroke="#e8e0d8" stroke-width="0.8" opacity="0.5"/>
                <circle cx="998.5" cy="412" r="1.5" fill="#e8c06a" opacity="0.4"/>
                <line x1="998.5" y1="408" x2="998.5" y2="404" stroke="#e8e0d8" stroke-width="0.6" opacity="0.4"/>

                <!-- === SAMAVAS FAMILY (left camp) === -->

                <!-- Samavas campfire -->
                <radialGradient id="fireGlowL" cx="280" cy="455" r="60" gradientUnits="userSpaceOnUse">
                    <stop offset="0%" stop-color="#d4874e" stop-opacity="0.25"/>
                    <stop offset="100%" stop-color="#d4874e" stop-opacity="0"/>
                </radialGradient>
                <circle cx="280" cy="455" r="60" fill="url(#fireGlowL)"/>
                <ellipse cx="280" cy="466" rx="12" ry="3.5" fill="none" stroke="#8a7a6a" stroke-width="1.2" opacity="0.3"/>
                <line x1="270" y1="467" x2="290" y2="467" stroke="#5a3a20" stroke-width="3" stroke-linecap="round"/>
                <line x1="272" y1="470" x2="288" y2="470" stroke="#4a2e18" stroke-width="2.5" stroke-linecap="round"/>
                <path d="M276 467 Q278 456 280 451 Q282 456 284 467" fill="#e8a44a" opacity="0.8"/>
                <path d="M274 467 Q278 453 280 447 Q282 453 286 467" fill="#d4874e" opacity="0.55"/>
                <path d="M277 467 Q279 458 280 454 Q281 458 283 467" fill="#e8c06a" opacity="0.5"/>
                <circle cx="278" cy="444" r="1" fill="#e8a44a" opacity="0.4"/>
                <circle cx="283" cy="442" r="0.8" fill="#e8c06a" opacity="0.3"/>

                <!-- Samavas dad sitting (left of fire) -->
                <circle cx="255" cy="448" r="6" fill="none" stroke="#e8e0d8" stroke-width="1.6"/>
                <path d="M255 454 L255 468" stroke="#e8e0d8" stroke-width="1.5" stroke-linecap="round"/>
                <path d="M255 459 L249 465" stroke="#e8e0d8" stroke-width="1.2" stroke-linecap="round"/>
                <path d="M255 459 L262 464" stroke="#e8e0d8" stroke-width="1.2" stroke-linecap="round"/>
                <path d="M255 468 L250 478" stroke="#e8e0d8" stroke-width="1.2" stroke-linecap="round"/>
                <path d="M255 468 L260 478" stroke="#e8e0d8" stroke-width="1.2" stroke-linecap="round"/>
                <!-- Chair -->
                <path d="M251 470 L247 479 M251 470 L255 479 M247 477 L255 477" fill="none" stroke="#e8e0d8" stroke-width="0.7" opacity="0.3"/>

                <!-- Samavas mum sitting (right of fire) -->
                <circle cx="305" cy="449" r="6" fill="none" stroke="#e8e0d8" stroke-width="1.6"/>
                <path d="M300 447 Q299 442 302 439" fill="none" stroke="#e8e0d8" stroke-width="0.8" stroke-linecap="round" opacity="0.5"/>
                <path d="M305 455 L305 468" stroke="#e8e0d8" stroke-width="1.5" stroke-linecap="round"/>
                <path d="M305 460 L299 465" stroke="#e8e0d8" stroke-width="1.2" stroke-linecap="round"/>
                <path d="M305 460 L312 464" stroke="#e8e0d8" stroke-width="1.2" stroke-linecap="round"/>
                <path d="M305 468 L300 478" stroke="#e8e0d8" stroke-width="1.2" stroke-linecap="round"/>
                <path d="M305 468 L310 478" stroke="#e8e0d8" stroke-width="1.2" stroke-linecap="round"/>
                <!-- Chair -->
                <path d="M302 470 L298 479 M302 470 L306 479 M298 477 L306 477" fill="none" stroke="#e8e0d8" stroke-width="0.7" opacity="0.3"/>

                <!-- Samavas kid playing near tent -->
                <circle cx="230" cy="435" r="4.5" fill="none" stroke="#e8e0d8" stroke-width="1.3"/>
                <path d="M230 439 L230 450" stroke="#e8e0d8" stroke-width="1.2" stroke-linecap="round"/>
                <path d="M230 444 L224 449" stroke="#e8e0d8" stroke-width="1" stroke-linecap="round"/>
                <path d="M230 444 L237 441" stroke="#e8e0d8" stroke-width="1" stroke-linecap="round"/>
                <path d="M230 450 L225 459" stroke="#e8e0d8" stroke-width="1" stroke-linecap="round"/>
                <path d="M230 450 L236 458" stroke="#e8e0d8" stroke-width="1" stroke-linecap="round"/>

                <!-- Samavas dog -->
                <ellipse cx="340" cy="472" rx="7" ry="3.5" fill="none" stroke="#e8e0d8" stroke-width="0.9" opacity="0.4"/>
                <circle cx="347" cy="469" r="2.5" fill="none" stroke="#e8e0d8" stroke-width="0.9" opacity="0.4"/>
                <path d="M349 467 L351 464" fill="none" stroke="#e8e0d8" stroke-width="0.7" opacity="0.3"/>

                <!-- === CHHAYA COUPLE (right camp) === -->

                <!-- Chhaya campfire (smaller) -->
                <radialGradient id="fireGlowR" cx="950" cy="458" r="45" gradientUnits="userSpaceOnUse">
                    <stop offset="0%" stop-color="#d4874e" stop-opacity="0.2"/>
                    <stop offset="100%" stop-color="#d4874e" stop-opacity="0"/>
                </radialGradient>
                <circle cx="950" cy="458" r="45" fill="url(#fireGlowR)"/>
                <ellipse cx="950" cy="468" rx="10" ry="3" fill="none" stroke="#8a7a6a" stroke-width="1" opacity="0.3"/>
                <line x1="942" y1="469" x2="958" y2="469" stroke="#5a3a20" stroke-width="2.5" stroke-linecap="round"/>
                <line x1="944" y1="472" x2="956" y2="472" stroke="#4a2e18" stroke-width="2" stroke-linecap="round"/>
                <path d="M947 469 Q949 460 950 456 Q951 460 953 469" fill="#e8a44a" opacity="0.75"/>
                <path d="M945 469 Q948 457 950 452 Q952 457 955 469" fill="#d4874e" opacity="0.5"/>
                <path d="M948 469 Q949 462 950 458 Q951 462 952 469" fill="#e8c06a" opacity="0.45"/>
                <circle cx="948" cy="449" r="0.8" fill="#e8a44a" opacity="0.35"/>
                <circle cx="953" cy="447" r="0.6" fill="#e8c06a" opacity="0.25"/>

                <!-- Person 1 sitting (left of fire) -->
                <circle cx="932" cy="452" r="5.5" fill="none" stroke="#e8e0d8" stroke-width="1.4"/>
                <path d="M932 457 L932 470" stroke="#e8e0d8" stroke-width="1.3" stroke-linecap="round"/>
                <path d="M932 462 L926 467" stroke="#e8e0d8" stroke-width="1.1" stroke-linecap="round"/>
                <path d="M932 462 L939 466" stroke="#e8e0d8" stroke-width="1.1" stroke-linecap="round"/>
                <path d="M932 470 L927 479" stroke="#e8e0d8" stroke-width="1.1" stroke-linecap="round"/>
                <path d="M932 470 L937 479" stroke="#e8e0d8" stroke-width="1.1" stroke-linecap="round"/>
                <!-- Chair -->
                <path d="M929 472 L925 480 M929 472 L933 480 M925 478 L933 478" fill="none" stroke="#e8e0d8" stroke-width="0.6" opacity="0.3"/>

                <!-- Person 2 sitting (right of fire) -->
                <circle cx="968" cy="453" r="5.5" fill="none" stroke="#e8e0d8" stroke-width="1.4"/>
                <path d="M963 451 Q962 446 965 443" fill="none" stroke="#e8e0d8" stroke-width="0.7" stroke-linecap="round" opacity="0.5"/>
                <path d="M968 458 L968 470" stroke="#e8e0d8" stroke-width="1.3" stroke-linecap="round"/>
                <path d="M968 463 L962 467" stroke="#e8e0d8" stroke-width="1.1" stroke-linecap="round"/>
                <path d="M968 463 L975 466" stroke="#e8e0d8" stroke-width="1.1" stroke-linecap="round"/>
                <path d="M968 470 L963 479" stroke="#e8e0d8" stroke-width="1.1" stroke-linecap="round"/>
                <path d="M968 470 L973 479" stroke="#e8e0d8" stroke-width="1.1" stroke-linecap="round"/>
                <!-- Chair -->
                <path d="M965 472 L961 480 M965 472 L969 480 M961 478 L969 478" fill="none" stroke="#e8e0d8" stroke-width="0.6" opacity="0.3"/>

                <!-- String lights (left side, Samavas) -->
                <path d="M145 365 Q200 355 260 332" fill="none" stroke="#e8e0d8" stroke-width="0.6" opacity="0.2"/>
                <circle cx="170" cy="362" r="1.8" fill="#e8c06a" opacity="0.3"/>
                <circle cx="200" cy="356" r="1.8" fill="#e8c06a" opacity="0.25"/>
                <circle cx="230" cy="346" r="1.8" fill="#e8c06a" opacity="0.3"/>

                <!-- String lights (right side, Chhaya) -->
                <path d="M1030 375 Q990 367 950 357" fill="none" stroke="#e8e0d8" stroke-width="0.6" opacity="0.2"/>
                <circle cx="1008" cy="373" r="1.8" fill="#e8c06a" opacity="0.3"/>
                <circle cx="985" cy="368" r="1.8" fill="#e8c06a" opacity="0.25"/>
                <circle cx="965" cy="362" r="1.8" fill="#e8c06a" opacity="0.3"/>

                <!-- Grass tufts scattered -->
                <path d="M350 450 Q353 442 356 450" fill="none" stroke="#4a6a4e" stroke-width="1" opacity="0.4"/>
                <path d="M500 458 Q503 451 506 458" fill="none" stroke="#4a6a4e" stroke-width="1" opacity="0.35"/>
                <path d="M700 455 Q703 448 706 455" fill="none" stroke="#4a6a4e" stroke-width="1" opacity="0.35"/>
                <path d="M850 450 Q853 443 856 450" fill="none" stroke="#4a6a4e" stroke-width="1" opacity="0.4"/>
                <path d="M420 465 Q423 458 426 465" fill="none" stroke="#4a6a4e" stroke-width="1" opacity="0.3"/>
                <path d="M780 460 Q783 453 786 460" fill="none" stroke="#4a6a4e" stroke-width="1" opacity="0.3"/>
                <path d="M240 455 Q243 448 246 455" fill="none" stroke="#4a6a4e" stroke-width="1" opacity="0.3"/>
                <path d="M960 458 Q963 451 966 458" fill="none" stroke="#4a6a4e" stroke-width="1" opacity="0.3"/>

                <!-- Stepping stones on path -->
                <ellipse cx="200" cy="435" rx="4.5" ry="2" fill="#4a6248" opacity="0.25"/>
                <ellipse cx="360" cy="430" rx="5" ry="2.5" fill="#4a6248" opacity="0.3"/>
                <ellipse cx="840" cy="430" rx="5" ry="2.5" fill="#4a6248" opacity="0.3"/>
                <ellipse cx="1000" cy="435" rx="4.5" ry="2" fill="#4a6248" opacity="0.25"/>

                <!-- Centre text readability overlay -->
                <ellipse cx="600" cy="290" rx="380" ry="260" fill="url(#textDim)"/>
            </svg>
        </div>

        <div class="camp-overlay">
            <div class="camp-text-label">The Camping Experience</div>
            <h2>Slow Down. <em>Breathe.</em> Reconnect.</h2>
            <p>Camp beneath ancient rainforest, fall asleep to the sounds of the creek, wake to birdsong, and let the rhythm of nature gently reset your pace.</p>
            <div class="camp-benefits">
                <div class="camp-benefit">
                    <div class="camp-benefit-icon"><svg viewBox="0 0 24 24"><path d="M12 22s-8-4.5-8-11.8A8 8 0 0 1 12 2a8 8 0 0 1 8 8.2c0 7.3-8 11.8-8 11.8z"/></svg></div>
                    <span>Reduces stress &amp; anxiety</span>
                </div>
                <div class="camp-benefit">
                    <div class="camp-benefit-icon"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/></svg></div>
                    <span>Better sleep &amp; fresh air</span>
                </div>
                <div class="camp-benefit">
                    <div class="camp-benefit-icon"><svg viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg></div>
                    <span>Quality time together</span>
                </div>
                <div class="camp-benefit">
                    <div class="camp-benefit-icon"><svg viewBox="0 0 24 24"><path d="M18 8h1a4 4 0 0 1 0 8h-1"/><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"/><line x1="6" y1="1" x2="6" y2="4"/><line x1="10" y1="1" x2="10" y2="4"/><line x1="14" y1="1" x2="14" y2="4"/></svg></div>
                    <span>Digital detox &amp; mindfulness</span>
                </div>
            </div>
            <button class="camp-cta-btn" onclick="scrollToBooking()">
                Ready to camp?
                <svg viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><polyline points="19 12 12 19 5 12"/></svg>
            </button>
        </div>
    </div>

    <!-- Progress indicator -->
    <div class="progress-bar">
        <div class="progress-step active" data-step="1">
            <span class="progress-num">1</span>
            <span>Search</span>
        </div>
        <div class="progress-line"></div>
        <div class="progress-step" data-step="2">
            <span class="progress-num">2</span>
            <span>Select</span>
        </div>
        <div class="progress-line"></div>
        <div class="progress-step" data-step="3">
            <span class="progress-num">3</span>
            <span>Add-ons</span>
        </div>
        <div class="progress-line"></div>
        <div class="progress-step" data-step="4">
            <span class="progress-num">4</span>
            <span>Details</span>
        </div>
        <div class="progress-line"></div>
        <div class="progress-step" data-step="5">
            <span class="progress-num">5</span>
            <span>Pay</span>
        </div>
    </div>

    <!-- Search bar (Step 1) -->
    <div class="search-bar">
        <div class="search-bar-inner">
            <div class="search-field">
                <label for="search-checkin">Check-in</label>
                <input type="text" id="search-checkin" readonly placeholder="DD/MM/YYYY">
            </div>
            <div class="search-field">
                <label for="search-checkout">Check-out</label>
                <input type="text" id="search-checkout" readonly placeholder="DD/MM/YYYY">
            </div>
            <div class="search-field">
                <label for="search-guests">Guests</label>
                <select id="search-guests">
                    <option value="1">1 guest</option>
                    <option value="2" selected>2 guests</option>
                </select>
            </div>
            <button type="button" class="btn-primary" onclick="checkAvailability()">Check Availability</button>
        </div>
    </div>

    <!-- Step 2: Select site -->
    <div class="wizard-step active" id="step-select">
        <div class="campsites" id="campsites-section" style="display:none">
            <!-- SAMAVAS -->
            <div class="campsite" id="campsite-samavas">
                <div class="campsite-media">
                    <div class="carousel" id="carousel-samavas"></div>
                </div>
                <div class="campsite-body">
                    <div class="campsite-header">
                        <div class="campsite-name">SAMAVAS</div>
                        <span class="max-badge" id="samavas-max-badge">Max 20 guests</span>
                    </div>
                    <div class="campsite-type" id="samavas-type">RV / Tent Site &middot; Sleeps 15 &middot; Vehicles under 30 m</div>
                    <p class="campsite-description" id="samavas-desc">
                        Our largest site, accommodating up to 15 people. Set furthest from the main house for maximum privacy, SAMAVAS is ideal for groups and families looking for a secluded spot in the rainforest.
                    </p>
                    <div class="campsite-amenities" id="samavas-highlights"></div>
                    <button class="details-toggle" onclick="toggleDetails('samavas')">View details &#9662;</button>
                    <div class="campsite-details" id="samavas-details" style="display:none">
                        <div class="details-meta" id="samavas-details-meta"></div>
                        <div id="samavas-details-cats"></div>
                    </div>
                    <div class="campsite-price" id="samavas-price">
                        from <strong>AU$66</strong> / night
                        <span class="price-note">for 2 guests</span>
                    </div>
                    <div class="price-breakdown-mini" id="samavas-breakdown" style="display:none;"></div>
                    <div class="date-warning" id="samavas-warning">Selected dates are unavailable for SAMAVAS. Please choose different dates.</div>
                    <div class="guest-message" id="samavas-guest-msg">
                        This site accommodates up to <strong><span>20</span> guests</strong>. Please select fewer guests.
                    </div>
                    <button type="button" class="btn-select" id="samavas-select-btn" onclick="selectSite('samavas')" disabled>Select dates first</button>
                </div>
            </div>

            <!-- CHHAYA -->
            <div class="campsite" id="campsite-chhaya">
                <div class="campsite-media">
                    <div class="carousel" id="carousel-chhaya"></div>
                </div>
                <div class="campsite-body">
                    <div class="campsite-header">
                        <div class="campsite-name">CHHAYA</div>
                        <span class="max-badge" id="chhaya-max-badge">Max 20 guests</span>
                    </div>
                    <div class="campsite-type" id="chhaya-type">RV / Tent Site &middot; Sleeps 6 &middot; Vehicles under 24 m</div>
                    <p class="campsite-description" id="chhaya-desc">
                        A cosy, intimate site perfect for couples and solo campers. CHHAYA is just a few metres from the toilets, offering convenience without sacrificing the peaceful rainforest setting.
                    </p>
                    <div class="campsite-amenities" id="chhaya-highlights"></div>
                    <button class="details-toggle" onclick="toggleDetails('chhaya')">View details &#9662;</button>
                    <div class="campsite-details" id="chhaya-details" style="display:none">
                        <div class="details-meta" id="chhaya-details-meta"></div>
                        <div id="chhaya-details-cats"></div>
                    </div>
                    <div class="campsite-price" id="chhaya-price">
                        from <strong>AU$60</strong> / night
                        <span class="price-note">for 2 guests</span>
                    </div>
                    <div class="price-breakdown-mini" id="chhaya-breakdown" style="display:none;"></div>
                    <div class="date-warning" id="chhaya-warning">Selected dates are unavailable for CHHAYA. Please choose different dates.</div>
                    <div class="guest-message" id="chhaya-guest-msg">
                        This site accommodates up to <strong><span>20</span> guests</strong>. Please select fewer guests.
                    </div>
                    <button type="button" class="btn-select" id="chhaya-select-btn" onclick="selectSite('chhaya')" disabled>Select dates first</button>
                </div>
            </div>
        </div>

        <div class="rules" id="campground-rules" style="display:none">
            <h2>Campground Rules</h2>
            <ul id="rules-list">
                <li>No parties allowed without prior permission</li>
                <li>No loud or open music</li>
                <li>All dogs must be kept on a leash when on the main campground</li>
            </ul>
        </div>

        <!-- Room listings (hidden by default) -->
        <div class="campsites" id="rooms-section">
            <!-- Garden View Room -->
            <div class="campsite" id="campsite-garden-view">
                <div class="campsite-media">
                    <div class="carousel" id="carousel-garden-view"></div>
                </div>
                <div class="campsite-body">
                    <div class="campsite-header">
                        <div class="campsite-name">GARDEN VIEW ROOM</div>
                        <span class="max-badge" id="garden-view-max-badge">Max 2 guests</span>
                    </div>
                    <div class="campsite-type" id="garden-view-type">Private Room &middot; Sleeps 2 &middot; Garden Views</div>
                    <p class="campsite-description" id="garden-view-desc">
                        A peaceful room overlooking the tropical garden. Surrounded by lush greenery, this room offers a tranquil retreat with easy access to all shared facilities.
                    </p>
                    <div class="campsite-amenities" id="garden-view-highlights"></div>
                    <button class="details-toggle" onclick="toggleDetails('garden-view')">View details &#9662;</button>
                    <div class="campsite-details" id="garden-view-details" style="display:none">
                        <div class="details-meta" id="garden-view-details-meta"></div>
                        <div id="garden-view-details-cats"></div>
                    </div>
                    <div class="campsite-price" id="garden-view-price">
                        from <strong>AU$75</strong> / night
                        <span class="price-note">for 1 guest</span>
                    </div>
                    <div class="price-breakdown-mini" id="garden-view-breakdown" style="display:none;"></div>
                    <div class="date-warning" id="garden-view-warning">Selected dates are unavailable for this room. Please choose different dates.</div>
                    <div class="guest-message" id="garden-view-guest-msg">
                        This room accommodates up to <strong><span>2</span> guests</strong>. Please select fewer guests.
                    </div>
                    <button type="button" class="btn-select" id="garden-view-select-btn" onclick="selectSite('garden-view')" disabled>Select dates first</button>
                </div>
            </div>

            <!-- Mountain View Room -->
            <div class="campsite" id="campsite-mountain-view">
                <div class="campsite-media">
                    <div class="carousel" id="carousel-mountain-view"></div>
                </div>
                <div class="campsite-body">
                    <div class="campsite-header">
                        <div class="campsite-name">MOUNTAIN VIEW ROOM</div>
                        <span class="max-badge" id="mountain-view-max-badge">Max 2 guests</span>
                    </div>
                    <div class="campsite-type" id="mountain-view-type">Private Room &middot; Sleeps 2 &middot; Mountain Views</div>
                    <p class="campsite-description" id="mountain-view-desc">
                        Wake up to stunning mountain views from this cosy private room. Perfect for couples or solo travellers looking for a budget-friendly stay with the comfort of a real bed and a roof overhead.
                    </p>
                    <div class="campsite-amenities" id="mountain-view-highlights"></div>
                    <button class="details-toggle" onclick="toggleDetails('mountain-view')">View details &#9662;</button>
                    <div class="campsite-details" id="mountain-view-details" style="display:none">
                        <div class="details-meta" id="mountain-view-details-meta"></div>
                        <div id="mountain-view-details-cats"></div>
                    </div>
                    <div class="campsite-price" id="mountain-view-price">
                        from <strong>AU$85</strong> / night
                        <span class="price-note">for 1 guest</span>
                    </div>
                    <div class="price-breakdown-mini" id="mountain-view-breakdown" style="display:none;"></div>
                    <div class="date-warning" id="mountain-view-warning">Selected dates are unavailable for this room. Please choose different dates.</div>
                    <div class="guest-message" id="mountain-view-guest-msg">
                        This room accommodates up to <strong><span>2</span> guests</strong>. Please select fewer guests.
                    </div>
                    <button type="button" class="btn-select" id="mountain-view-select-btn" onclick="selectSite('mountain-view')" disabled>Select dates first</button>
                </div>
            </div>

            <!-- Suite with Garden View -->
            <div class="campsite" id="campsite-suite">
                <div class="campsite-media">
                    <div class="carousel" id="carousel-suite"></div>
                </div>
                <div class="campsite-body">
                    <div class="campsite-header">
                        <div class="campsite-name">SUITE WITH GARDEN VIEW</div>
                        <span class="max-badge" id="suite-max-badge">Max 4 guests</span>
                    </div>
                    <div class="campsite-type" id="suite-type">Private Suite &middot; Sleeps 4 &middot; Garden Views</div>
                    <p class="campsite-description" id="suite-desc">
                        Our most spacious room option — a private suite with separate living area and garden views. Ideal for small families or couples wanting extra space in the heart of the rainforest.
                    </p>
                    <div class="campsite-amenities" id="suite-highlights"></div>
                    <button class="details-toggle" onclick="toggleDetails('suite')">View details &#9662;</button>
                    <div class="campsite-details" id="suite-details" style="display:none">
                        <div class="details-meta" id="suite-details-meta"></div>
                        <div id="suite-details-cats"></div>
                    </div>
                    <div class="campsite-price" id="suite-price">
                        from <strong>AU$110</strong> / night
                        <span class="price-note">for 2 guests</span>
                    </div>
                    <div class="price-breakdown-mini" id="suite-breakdown" style="display:none;"></div>
                    <div class="date-warning" id="suite-warning">Selected dates are unavailable for this suite. Please choose different dates.</div>
                    <div class="guest-message" id="suite-guest-msg">
                        This suite accommodates up to <strong><span>4</span> guests</strong>. Please select fewer guests.
                    </div>
                    <button type="button" class="btn-select" id="suite-select-btn" onclick="selectSite('suite')" disabled>Select dates first</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Step 3: Add-ons -->
    <div class="wizard-step" id="step-addons">
        <div class="step-content">
            <h2 class="step-title">Add-ons for <span id="addons-site-name">SAMAVAS</span></h2>
            <p class="step-subtitle">Enhance your stay</p>

            <div id="addons-list"></div>

            <div class="summary-box" id="addons-summary">
                <div class="summary-title">Booking Summary</div>
                <div id="addons-summary-content"></div>
            </div>

            <div class="step-nav">
                <button type="button" class="btn-secondary" onclick="goToStep(2)">&larr; Back</button>
                <button type="button" class="btn-primary" onclick="goToStep(4)">Continue to Details</button>
            </div>
        </div>
    </div>

    <!-- Step 4: Your Details -->
    <div class="wizard-step" id="step-details">
        <div class="step-content">
            <h2 class="step-title">Your Details</h2>
            <p class="step-subtitle">Please provide your contact information</p>

            <div class="details-form">
                <div class="form-row">
                    <div class="form-field">
                        <label for="guest-name">Full Name</label>
                        <input type="text" id="guest-name" placeholder="Your full name" required>
                    </div>
                    <div class="form-field">
                        <label for="guest-email">Email</label>
                        <input type="email" id="guest-email" placeholder="you@email.com" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-field">
                        <label for="guest-phone">Phone</label>
                        <input type="tel" id="guest-phone" placeholder="+61 4XX XXX XXX" required>
                    </div>
                    <div class="form-field">
                        <label for="guest-promo">Promo Code</label>
                        <div class="promo-row">
                            <input type="text" id="guest-promo" placeholder="Optional">
                            <button type="button" class="promo-apply" onclick="applyPromo()">Apply</button>
                        </div>
                        <div class="promo-msg" id="promo-msg"></div>
                    </div>
                </div>
            </div>

            <div class="summary-box" id="details-summary">
                <div class="summary-title">Booking Summary</div>
                <div id="details-summary-content"></div>
            </div>

            <div class="step-nav">
                <button type="button" class="btn-secondary" onclick="goToStep(3)">&larr; Back</button>
                <button type="button" class="btn-primary" onclick="goToStep(5)">Review Booking</button>
            </div>
        </div>
    </div>

    <!-- Step 5: Review & Pay -->
    <div class="wizard-step" id="step-review">
        <div class="step-content">
            <h2 class="step-title">Review Your Booking</h2>
            <p class="step-subtitle">Please confirm your details before proceeding to payment</p>

            <div class="review-card">
                <div class="review-section">
                    <div class="review-section-title">Stay Details</div>
                    <div class="review-row">
                        <span class="label">Campsite</span>
                        <span id="review-site"></span>
                    </div>
                    <div class="review-row">
                        <span class="label">Check-in</span>
                        <span id="review-checkin"></span>
                    </div>
                    <div class="review-row">
                        <span class="label">Check-out</span>
                        <span id="review-checkout"></span>
                    </div>
                    <div class="review-row">
                        <span class="label">Guests</span>
                        <span id="review-guests"></span>
                    </div>
                </div>

                <div class="review-section">
                    <div class="review-section-title">Contact Information</div>
                    <div class="review-row">
                        <span class="label">Name</span>
                        <span id="review-name"></span>
                    </div>
                    <div class="review-row">
                        <span class="label">Email</span>
                        <span id="review-email"></span>
                    </div>
                    <div class="review-row">
                        <span class="label">Phone</span>
                        <span id="review-phone"></span>
                    </div>
                </div>

                <div class="review-section">
                    <div class="review-section-title">Price Breakdown</div>
                    <div id="review-breakdown"></div>
                </div>
            </div>

            <div class="tc-agreement">
                <input type="checkbox" id="tc-agree">
                <label for="tc-agree">I have read and agree to the <a href="#" onclick="openTcModal(); return false;">Terms &amp; Conditions</a> and cancellation policy</label>
            </div>
            <p class="tc-error" id="tc-error">Please agree to the Terms &amp; Conditions to continue.</p>

            <div class="step-nav">
                <button type="button" class="btn-secondary" onclick="goToStep(4)">&larr; Back</button>
                <button type="button" class="btn-primary" id="btn-book" onclick="submitBooking()">Book & Pay</button>
            </div>
        </div>
    </div>

    <!-- Guest Reviews -->
    <div class="reviews-strip" id="reviews-strip">
        <div class="reviews-strip-title"><em>Loved</em> by Our Guests</div>
        <div class="reviews-scroll" id="reviews-scroll"></div>
    </div>

    <footer class="footer">
        <div class="footer-links">
            <a href="/disclaimer">Disclaimer</a> &middot; <a href="/terms-and-conditions">Terms &amp; Conditions</a> &middot; <a href="/contact">Contact</a>
        </div>
        &copy; 2026 Ahana Hillside &middot; ABN: 731 5158 2872
    </footer>

    <!-- T&C Modal -->
    <div class="tc-overlay" id="tc-overlay" onclick="if(event.target===this)closeTcModal()">
        <div class="tc-modal">
            <div class="tc-modal-header">
                <h3>Terms &amp; Conditions</h3>
                <button class="tc-modal-close" onclick="closeTcModal()">&times;</button>
            </div>
            <div class="tc-modal-body" id="tc-modal-body">
            </div>
        </div>
    </div>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox">
        <button class="lightbox-close">&times;</button>
        <button class="lightbox-btn lightbox-prev">&#8249;</button>
        <img class="lightbox-img" id="lightbox-img" src="" alt="">
        <button class="lightbox-btn lightbox-next">&#8250;</button>
        <div class="lightbox-counter" id="lightbox-counter"></div>
    </div>

    <script>
        const WORKER_URL = 'https://ahana-ical-proxy.ahanahillside.workers.dev';

        // --- Load guest reviews ---
        (async function() {
            try {
                var res = await fetch(WORKER_URL + '/reviews');
                var data = await res.json();
                var reviews = data.reviews || [];
                if (reviews.length === 0) return;

                var sourceColors = { booking: '#003580', hipcamp: '#2D6A4F', google: '#EA4335', direct: '#A69583' };
                var sourceLabels = { booking: 'Booking.com', hipcamp: 'Hipcamp', google: 'Google', direct: 'Direct Guest' };
                var esc = function(s) { return (s || '').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); };

                var container = document.getElementById('reviews-scroll');
                container.innerHTML = reviews.map(function(r) {
                    var srcColor = sourceColors[r.source] || '#666';
                    var srcLabel = sourceLabels[r.source] || r.source;
                    var score = r.score || 10;
                    var liked = r.liked || r.text || '';
                    var countryStr = r.country ? '<span class="review-mini-country">' + esc(r.country.toUpperCase()) + '</span>' : '';
                    return '<div class="review-mini">'
                        + '<div class="review-mini-top">'
                        + '<div class="review-mini-score" style="background:' + srcColor + '">' + score + '</div>'
                        + '<div class="review-mini-info">'
                        + '<span class="review-mini-name">' + esc(r.guestName) + '</span>'
                        + countryStr
                        + '<span class="review-mini-badge" style="background:' + srcColor + '">' + srcLabel + '</span>'
                        + '</div></div>'
                        + (r.title ? '<div class="review-mini-title">' + esc(r.title) + '</div>' : '')
                        + '<div class="review-mini-liked"><span class="rm-icon">&#9786;</span>' + esc(liked) + '</div>'
                        + '</div>';
                }).join('');

                document.getElementById('reviews-strip').style.display = 'block';
            } catch (err) {}
        })();

        // --- Wizard state ---
        let currentStep = 2;
        let selectedSite = null;
        let addons = {};
        let appliedPromo = null;
        let activeCategory = 'rooms';
        let selectedCancellationPolicy = 'flexible'; // 'flexible' or 'non-refundable'

        // --- Category toggle ---
        function switchCategory(category) {
            activeCategory = category;
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.category === category);
            });
            var campExp = document.querySelector('.camp-experience');
            var campsitesSection = document.getElementById('campsites-section');
            var roomsSection = document.getElementById('rooms-section');
            var campRules = document.getElementById('campground-rules');
            if (category === 'campsites') {
                if (campExp) campExp.style.display = '';
                campsitesSection.style.display = '';
                roomsSection.style.display = 'none';
                if (campRules) campRules.style.display = '';
            } else {
                if (campExp) campExp.style.display = 'none';
                campsitesSection.style.display = 'none';
                roomsSection.style.display = '';
                if (campRules) campRules.style.display = 'none';
            }
            // Reset selection when switching
            selectedSite = null;
            updateAllCards();
            // Re-render any open date picker to update blocked dates
            ['checkin', 'checkout'].forEach(f => {
                var dd = document.querySelector('.date-picker-wrapper .dp-dropdown');
                if (dd && dd.style.display !== 'none') renderCalendar(f);
            });
        }

        // --- Image carousel & lightbox ---
        const SITES = {
            samavas: { folder: 'images/samavas/', maxImages: 10, alt: 'SAMAVAS campsite at Ahana Hillside', category: 'campsites' },
            chhaya:  { folder: 'images/chhaya/',  maxImages: 10, alt: 'CHHAYA campsite at Ahana Hillside', category: 'campsites' },
            'mountain-view': { folder: 'images/mountain-view/', maxImages: 10, alt: 'Mountain View Room at Ahana Hillside', category: 'rooms' },
            'garden-view':   { folder: 'images/garden-view/',   maxImages: 10, alt: 'Garden View Room at Ahana Hillside', category: 'rooms' },
            'suite':         { folder: 'images/suite/',         maxImages: 10, alt: 'Suite with Garden View at Ahana Hillside', category: 'rooms' },
        };

        const carousels = {};
        let lightboxImages = [];
        let lightboxIndex = 0;

        async function probeImages(folder, max) {
            const found = [];
            for (let i = 1; i <= max; i++) {
                const src = folder + i + '.jpg';
                const exists = await new Promise(resolve => {
                    const img = new Image();
                    img.onload = () => resolve(true);
                    img.onerror = () => resolve(false);
                    img.src = src;
                });
                if (exists) found.push(src);
            }
            return found;
        }

        function buildCarousel(containerId, media, alt) {
            const container = document.getElementById(containerId);
            if (media.length === 0) {
                container.innerHTML = '<div style="width:100%;height:100%;background:linear-gradient(135deg,#2C3E2D,#4a6b4d);display:flex;align-items:center;justify-content:center;color:rgba(255,255,255,0.3);font-size:0.8rem;letter-spacing:0.1em;text-transform:uppercase;">Photos coming soon</div>';
                return;
            }

            const site = containerId.replace('carousel-', '');
            carousels[site] = { media, index: 0 };

            let html = '<div class="carousel-track">';
            media.forEach((item, i) => {
                html += '<div class="carousel-slide" data-site="' + site + '" data-index="' + i + '">';
                if (item.type === 'video') {
                    html += '<video src="' + item.url + '" muted loop playsinline preload="metadata" style="width:100%;height:100%;object-fit:cover"></video>';
                } else {
                    html += '<img src="' + item.url + '" alt="' + alt + ' — photo ' + (i + 1) + '">';
                }
                html += '</div>';
            });
            html += '</div>';

            if (media.length > 1) {
                html += '<button class="carousel-btn carousel-btn-prev" data-site="' + site + '">&#8249;</button>';
                html += '<button class="carousel-btn carousel-btn-next" data-site="' + site + '">&#8250;</button>';
                html += '<div class="carousel-dots">';
                media.forEach((_, i) => {
                    html += '<button class="carousel-dot' + (i === 0 ? ' active' : '') + '" data-site="' + site + '" data-dot="' + i + '"></button>';
                });
                html += '</div>';
            }

            html += '<div class="carousel-counter">' + '1 / ' + media.length + '</div>';
            container.innerHTML = html;

            container.querySelectorAll('.carousel-slide').forEach(slide => {
                slide.addEventListener('click', () => {
                    const idx = parseInt(slide.dataset.index);
                    const item = carousels[site].media[idx];
                    if (item.type === 'video') {
                        // Toggle play/pause for videos
                        const video = slide.querySelector('video');
                        if (video) { video.paused ? video.play() : video.pause(); }
                    } else {
                        openLightbox(carousels[site].media.filter(m => m.type === 'image').map(m => m.url), carousels[site].media.slice(0, idx + 1).filter(m => m.type === 'image').length - 1);
                    }
                });
            });

            const prevBtn = container.querySelector('.carousel-btn-prev');
            const nextBtn = container.querySelector('.carousel-btn-next');
            if (prevBtn) prevBtn.addEventListener('click', (e) => { e.stopPropagation(); moveCarousel(site, -1); });
            if (nextBtn) nextBtn.addEventListener('click', (e) => { e.stopPropagation(); moveCarousel(site, 1); });

            container.querySelectorAll('.carousel-dot').forEach(dot => {
                dot.addEventListener('click', (e) => {
                    e.stopPropagation();
                    goToSlide(site, parseInt(dot.dataset.dot));
                });
            });
        }

        function moveCarousel(site, dir) {
            const c = carousels[site];
            c.index = (c.index + dir + c.media.length) % c.media.length;
            updateCarousel(site);
        }

        function goToSlide(site, index) {
            carousels[site].index = index;
            updateCarousel(site);
        }

        function updateCarousel(site) {
            const c = carousels[site];
            const container = document.getElementById('carousel-' + site);
            const track = container.querySelector('.carousel-track');
            track.style.transform = 'translateX(-' + (c.index * 100) + '%)';

            container.querySelectorAll('.carousel-dot').forEach((dot, i) => {
                dot.classList.toggle('active', i === c.index);
            });

            const counter = container.querySelector('.carousel-counter');
            if (counter) counter.textContent = (c.index + 1) + ' / ' + c.media.length;

            // Auto-play video when it's the active slide, pause others
            container.querySelectorAll('.carousel-slide').forEach((slide, i) => {
                const video = slide.querySelector('video');
                if (video) {
                    if (i === c.index) { video.play().catch(() => {}); }
                    else { video.pause(); video.currentTime = 0; }
                }
            });
        }

        // --- Lightbox ---
        function openLightbox(images, index) {
            lightboxImages = images;
            lightboxIndex = index;
            updateLightbox();
            document.getElementById('lightbox').classList.add('open');
            document.body.style.overflow = 'hidden';
        }

        function closeLightbox() {
            document.getElementById('lightbox').classList.remove('open');
            document.body.style.overflow = '';
        }

        function updateLightbox() {
            document.getElementById('lightbox-img').src = lightboxImages[lightboxIndex];
            document.getElementById('lightbox-counter').textContent = (lightboxIndex + 1) + ' / ' + lightboxImages.length;
        }

        document.querySelector('.lightbox-close').addEventListener('click', closeLightbox);
        document.querySelector('.lightbox-prev').addEventListener('click', () => {
            lightboxIndex = (lightboxIndex - 1 + lightboxImages.length) % lightboxImages.length;
            updateLightbox();
        });
        document.querySelector('.lightbox-next').addEventListener('click', () => {
            lightboxIndex = (lightboxIndex + 1) % lightboxImages.length;
            updateLightbox();
        });

        document.getElementById('lightbox').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) closeLightbox();
        });

        document.addEventListener('keydown', (e) => {
            if (!document.getElementById('lightbox').classList.contains('open')) return;
            if (e.key === 'Escape') closeLightbox();
            if (e.key === 'ArrowLeft') { lightboxIndex = (lightboxIndex - 1 + lightboxImages.length) % lightboxImages.length; updateLightbox(); }
            if (e.key === 'ArrowRight') { lightboxIndex = (lightboxIndex + 1) % lightboxImages.length; updateLightbox(); }
        });

        // --- Init carousels ---
        async function initCarousels() {
            for (const [site, cfg] of Object.entries(SITES)) {
                let media = [];
                try {
                    const res = await fetch(WORKER_URL + '/images/list/' + site);
                    const data = await res.json();
                    if (data.images && data.images.length > 0) {
                        media = data.images.map(img => ({
                            url: WORKER_URL + '/images/' + site + '/' + img.id,
                            type: img.mediaType === 'video' || (img.contentType && img.contentType.startsWith('video/')) ? 'video' : 'image',
                        }));
                    }
                } catch (e) {}
                if (media.length === 0) {
                    const fallback = await probeImages(cfg.folder, cfg.maxImages);
                    media = fallback.map(src => ({ url: src, type: 'image' }));
                }
                buildCarousel('carousel-' + site, media, cfg.alt);
            }
        }
        initCarousels();

        // --- Camping experience custom background ---
        (async function() {
            try {
                const res = await fetch(WORKER_URL + '/campsite-bg/info');
                const data = await res.json();
                if (!data.exists) return;
                const scene = document.querySelector('.camp-scene');
                if (!scene) return;
                const url = WORKER_URL + '/campsite-bg';
                if (data.mediaType === 'video') {
                    scene.innerHTML = '<video src="' + url + '" autoplay muted loop playsinline style="width:100%;height:100%;object-fit:cover"></video>';
                } else {
                    scene.innerHTML = '<img src="' + url + '" alt="Camping experience" style="width:100%;height:100%;object-fit:cover">';
                }
            } catch (e) {}
        })();

        // --- Configuration ---
        const DEFAULT_CONFIG = {
            samavas: { basePrice: 66, extraGuestFee: 15, maxGuests: 20 },
            chhaya:  { basePrice: 60, extraGuestFee: 10, maxGuests: 20 },
            'mountain-view': { basePrice: 85, extraGuestFee: 25, maxGuests: 2 },
            'garden-view':   { basePrice: 75, extraGuestFee: 20, maxGuests: 2 },
            'suite':         { basePrice: 110, extraGuestFee: 30, maxGuests: 4 },
            currency: 'AUD',
            promoCodes: {},
            rules: [],
            checkinTime: '3:00 PM',
            checkoutTime: '10:00 AM',
            termsAndConditions: '1. Booking and Payment\n\nAll bookings must be made through our official website, Booking.com, or other authorised platforms.\nFull payment is required at the time of booking unless otherwise stated.\nPrices are listed in Australian Dollars (AUD) and include GST where applicable.\nA valid credit or debit card is required to secure your booking.\nAhana Hillside reserves the right to cancel any booking suspected of being fraudulent.\n\n2. Cancellation and Refund Policy\n\nWe offer two rate plans when booking:\n\nFlexible Rate — Guests may cancel free of charge up to 14 days before the scheduled check-in date. Cancellations made less than 14 days before check-in are non-refundable.\n\nNon-Refundable Rate — A discounted rate is offered in exchange for a non-refundable commitment. Bookings made at the non-refundable rate cannot be cancelled, amended, or refunded under any circumstances.\n\nThe cancellation window and non-refundable discount percentage may vary and will be displayed at the time of booking. Refunds for eligible cancellations will be processed to the original payment method within 5–10 business days.\n\n3. Weather-Related Cancellations\n\nIf severe weather conditions (e.g., cyclones, floods, extreme storms) make it unsafe to stay at the property, guests may reschedule their booking at no extra cost, subject to availability.\nAhana Hillside reserves the right to close the campsite due to weather conditions for the safety of guests.\nRefunds will not be issued for weather-related cancellations, but credit towards a future booking will be offered.\n\n4. Check-in and Check-out\n\nCheck-in time: 3:00 PM. Check-out time: 10:00 AM.\nEarly check-in and late check-out may be available upon request, subject to availability.\nGuests must vacate their campsite or room by the check-out time. Additional charges may apply for late departures.\n\n5. Guest Responsibilities\n\nGuests are responsible for keeping their campsite/room clean and tidy.\nAny damage to property, furniture, or equipment will be charged to the guest.\nExcessive noise is not permitted between 10:00 PM and 7:00 AM.\nGuests must follow all fire safety rules, including the use of designated fire pits only.\nAll rubbish must be disposed of properly; please follow our waste and recycling guidelines.\n\n6. Liability\n\nAhana Hillside is not responsible for loss, theft, or damage to personal belongings.\nGuests use all facilities at their own risk.\nBy staying at Ahana Hillside, guests acknowledge and accept the inherent risks of outdoor and nature-based accommodation.\n\n7. Smoking and Alcohol\n\nSmoking is only permitted in designated areas. Breaching this may result in eviction without refund.\nAlcohol is permitted but must be consumed responsibly. Ahana Hillside reserves the right to remove guests who cause disturbances due to intoxication.\n\n8. Pets\n\nPets are not allowed on the property unless explicitly stated otherwise.\nService animals are welcome with prior notification.\n\n9. Use of Facilities\n\nAll guests must follow the posted rules for use of shared amenities, including bathrooms, BBQ areas, and fire pits.\nAhana Hillside reserves the right to restrict access to any facility for safety or maintenance reasons.\n\n10. Amendments to Terms\n\nAhana Hillside reserves the right to update these terms and conditions at any time. Any changes will be communicated on our website.',
            weekendMarkup: 20,
            holidayMarkup: 25,
            cancellationDays: 14,
            nonRefundableDiscount: 10,
            otaMarkup: 15,
        };

        let siteConfig = DEFAULT_CONFIG;
        let holidayDates = {}; // { 'YYYY-MM-DD': 'Holiday Name' }

        const CURRENCY_SYMBOLS = { AUD: 'AU$', USD: 'US$', EUR: '\u20AC', GBP: '\u00A3' };

        function currencySymbol() {
            return CURRENCY_SYMBOLS[siteConfig.currency] || siteConfig.currency + ' ';
        }

        // --- State ---
        const bookedDates = { samavas: [], chhaya: [], 'mountain-view': [], 'garden-view': [], 'suite': [] };

        // --- Search bar helpers ---
        function getSearchDate(field) {
            return document.getElementById('search-' + field).dataset.date || '';
        }

        function setSearchDate(field, isoDate) {
            const input = document.getElementById('search-' + field);
            input.dataset.date = isoDate || '';
            if (isoDate) {
                const [y, m, d] = isoDate.split('-');
                input.value = d + '/' + m + '/' + y;
            } else {
                input.value = '';
            }
        }

        function getSearchGuests() {
            return parseInt(document.getElementById('search-guests').value) || 2;
        }

        // --- Check availability (button) ---
        function checkAvailability() {
            const checkin = getSearchDate('checkin');
            const checkout = getSearchDate('checkout');

            if (!checkin || !checkout) {
                alert('Please select check-in and check-out dates.');
                return;
            }

            updateAllCards();
            updateProgress(2);
            var targetSection = activeCategory === 'campsites' ? document.getElementById('campsites-section') : document.getElementById('rooms-section');
            targetSection.scrollIntoView({ behavior: 'smooth' });
        }

        // --- Update all campsite cards ---
        const ALL_SITES = ['samavas', 'chhaya', 'mountain-view', 'garden-view', 'suite'];
        const CAMPSITE_SITES = ['samavas', 'chhaya'];
        const ROOM_SITES = ['mountain-view', 'garden-view', 'suite'];

        function updateAllCards() {
            ALL_SITES.forEach(site => {
                updatePerNightPrice(site);
                updatePriceBreakdown(site);
                updateWarning(site);
                updateSelectButton(site);
            });
            updateGuestAvailability();
        }

        // --- Update select button state ---
        function updateSelectButton(site) {
            const checkin = getSearchDate('checkin');
            const checkout = getSearchDate('checkout');
            const btn = document.getElementById(site + '-select-btn');
            const hasConflict = updateWarning(site);

            if (!checkin || !checkout) {
                btn.disabled = true;
                btn.textContent = 'Select dates first';
            } else if (hasConflict) {
                btn.disabled = true;
                btn.textContent = 'Dates unavailable';
            } else {
                btn.disabled = false;
                var displayName = SITES[site] ? (SITES[site].alt || site).split(' at ')[0] : site.toUpperCase();
                btn.textContent = 'Select ' + displayName;
            }
        }

        // --- Guest availability: grey out sites that exceed max ---
        function updateGuestAvailability() {
            const guests = getSearchGuests();

            ALL_SITES.forEach(site => {
                const cfg = siteConfig[site];
                if (!cfg) return;
                const maxG = cfg.maxGuests || 20;
                const card = document.getElementById('campsite-' + site);
                if (!card) return;

                if (guests > maxG) {
                    card.classList.add('guest-exceeded');
                } else {
                    card.classList.remove('guest-exceeded');
                }
            });
        }

        // --- Guest change listener ---
        document.getElementById('search-guests').addEventListener('change', () => {
            updateAllCards();
        });

        // --- Fetch site config from worker ---
        async function fetchConfig() {
            try {
                const res = await fetch(WORKER_URL + '/config');
                if (!res.ok) throw new Error('HTTP ' + res.status);
                const data = await res.json();
                if (data && data.samavas) {
                    siteConfig = data;
                    applyConfig();
                }
            } catch (err) {
                console.warn('Config fetch failed, using defaults:', err);
            }
            // Also fetch public holidays (await so holiday markup is ready before user interacts)
            await fetchHolidays();
        }

        async function fetchHolidays() {
            try {
                const now = new Date();
                const year = now.getFullYear();
                const res = await fetch(WORKER_URL + '/holidays?year=' + year + ',' + (year + 1));
                if (!res.ok) return;
                const data = await res.json();
                if (data && data.holidays) {
                    holidayDates = {};
                    data.holidays.forEach(function(h) { holidayDates[h.date] = h.name; });
                }
            } catch (err) {
                console.warn('Holidays fetch failed:', err);
            }
        }

        // --- Rate helpers (rooms only — campsites use flat rates) ---
        function isRoom(site) {
            return ROOM_SITES.includes(site);
        }

        function isWeekendNight(dateStr) {
            // A "night" of Fri or Sat means the guest is staying that night
            const d = new Date(dateStr + 'T12:00:00');
            const dow = d.getDay(); // 0=Sun, 5=Fri, 6=Sat
            return dow === 5 || dow === 6;
        }

        function isHolidayNight(dateStr) {
            return !!holidayDates[dateStr];
        }

        // Get the nightly rate for a room on a given date
        function getBaseRate(site) {
            const cfg = siteConfig[site];
            if (!cfg) return 0;
            const guestCount = getSearchGuests();
            return (guestCount === 1 && cfg.soloPrice) ? cfg.soloPrice : cfg.basePrice;
        }

        function getNightlyRate(site, dateStr) {
            const cfg = siteConfig[site];
            if (!cfg) return 0;
            const base = getBaseRate(site);
            if (!isRoom(site)) return base; // campsites: flat rate always
            const wkPct = siteConfig.weekendMarkup || 0;
            const holPct = siteConfig.holidayMarkup || 0;
            // Holiday takes precedence if both apply (don't stack)
            if (holPct > 0 && isHolidayNight(dateStr)) {
                return Math.round(base * (1 + holPct / 100));
            }
            if (wkPct > 0 && isWeekendNight(dateStr)) {
                return Math.round(base * (1 + wkPct / 100));
            }
            return base;
        }

        // Calculate total accommodation cost for a stay, returning per-night detail
        function calculateNightlyBreakdown(site, checkin, checkout) {
            const dates = getDatesInRange(checkin, checkout);
            let totalBase = 0;
            let weekendNights = 0;
            let holidayNights = 0;
            let standardNights = 0;
            const nightDetails = [];

            dates.forEach(function(dateStr) {
                const rate = getNightlyRate(site, dateStr);
                const type = isRoom(site) && isHolidayNight(dateStr) ? 'holiday'
                           : isRoom(site) && isWeekendNight(dateStr) ? 'weekend'
                           : 'standard';
                if (type === 'holiday') holidayNights++;
                else if (type === 'weekend') weekendNights++;
                else standardNights++;
                totalBase += rate;
                nightDetails.push({ date: dateStr, rate: rate, type: type });
            });

            return {
                totalBase: totalBase,
                standardNights: standardNights,
                weekendNights: weekendNights,
                holidayNights: holidayNights,
                nightDetails: nightDetails,
                nights: dates.length
            };
        }

        function escapeHtml(str) {
            var div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        }

        function tagIcon(name) {
            var n = name.toLowerCase();
            // View / scenery
            if (n.includes('mountain view')) return '<svg viewBox="0 0 24 24"><path d="M8 21l4-10 4 10"/><path d="M2 21l5-7 3 4"/><circle cx="18" cy="5" r="2"/></svg>';
            if (n.includes('garden view') || n.includes('garden')) return '<svg viewBox="0 0 24 24"><path d="M12 18V12"/><path d="M8 18c0-3.3 1.8-6 4-6s4 2.7 4 6"/><path d="M6 18c0-5 2.7-9 6-9"/><path d="M18 18c0-5-2.7-9-6-9"/><line x1="3" y1="21" x2="21" y2="21"/></svg>';
            if (n.includes('courtyard')) return '<svg viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>';
            if (n.includes('view')) return '<svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M2 12s3.5-7 10-7 10 7 10 7-3.5 7-10 7S2 12 2 12z"/></svg>';
            // Outdoor
            if (n.includes('balcony')) return '<svg viewBox="0 0 24 24"><path d="M3 10h18v2H3z"/><path d="M5 12v8"/><path d="M19 12v8"/><path d="M12 12v8"/><path d="M3 20h18"/><path d="M7 3v7"/><path d="M17 3v7"/></svg>';
            if (n.includes('patio') || n.includes('terrace') || n.includes('deck')) return '<svg viewBox="0 0 24 24"><path d="M12 3v18"/><path d="M3 12l9-9 9 9"/><path d="M8 21h8"/></svg>';
            if (n.includes('outdoor furniture')) return '<svg viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="3" rx="1"/><path d="M5 14v5"/><path d="M19 14v5"/><path d="M6 11V8a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v3"/></svg>';
            if (n.includes('outdoor dining')) return '<svg viewBox="0 0 24 24"><line x1="3" y1="11" x2="21" y2="11"/><path d="M5 11v9"/><path d="M19 11v9"/><path d="M12 11v9"/><path d="M8 11V7"/><path d="M16 11V7"/></svg>';
            // Climate
            if (n.includes('air con')) return '<svg viewBox="0 0 24 24"><rect x="2" y="4" width="20" height="8" rx="2"/><path d="M6 16v2"/><path d="M10 16v4"/><path d="M14 16v2"/><path d="M18 16v4"/><path d="M6 12v1"/><path d="M18 12v1"/></svg>';
            if (n.includes('fan') && !n.includes('infant')) return '<svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="2"/><path d="M12 2c3 3 2 7 0 10"/><path d="M22 12c-3 3-7 2-10 0"/><path d="M12 22c-3-3-2-7 0-10"/><path d="M2 12c3-3 7-2 10 0"/></svg>';
            if (n.includes('heating')) return '<svg viewBox="0 0 24 24"><path d="M12 2c1.5 2 3 4 3 6.5S13.5 13 12 13s-3-2-3-4.5S10.5 4 12 2z"/><path d="M5 21h14"/><path d="M8 18h8v3H8z"/></svg>';
            // Bathroom
            if (n.includes('shower')) return '<svg viewBox="0 0 24 24"><circle cx="12" cy="5" r="2"/><path d="M8 9l2 5v7"/><path d="M16 9l-2 5v7"/><path d="M7 21h2"/><path d="M15 21h2"/></svg>';
            if (n.includes('toilet') && !n.includes('paper')) return '<svg viewBox="0 0 24 24"><path d="M7 19h10v2H7z"/><path d="M8 12h8v7H8z"/><path d="M9 6h6a2 2 0 0 1 2 2v4H7V8a2 2 0 0 1 2-2z"/></svg>';
            if (n.includes('toilet paper')) return '<svg viewBox="0 0 24 24"><circle cx="10" cy="12" r="6"/><ellipse cx="10" cy="12" rx="2" ry="6"/><path d="M16 6v12c0 1.1.9 2 2 2h2V4h-2c-1.1 0-2 .9-2 2z"/></svg>';
            if (n.includes('towel')) return '<svg viewBox="0 0 24 24"><rect x="4" y="3" width="16" height="18" rx="2"/><line x1="4" y1="8" x2="20" y2="8"/><line x1="4" y1="13" x2="20" y2="13"/><line x1="4" y1="18" x2="20" y2="18"/></svg>';
            if (n.includes('toiletries') || n.includes('free toiletries')) return '<svg viewBox="0 0 24 24"><rect x="8" y="6" width="4" height="14" rx="1"/><path d="M10 6V4"/><rect x="15" y="9" width="3" height="11" rx="1"/><path d="M16.5 9V7"/></svg>';
            if (n.includes('hairdryer') || n.includes('hair dryer')) return '<svg viewBox="0 0 24 24"><path d="M3 10h4l5 5v-9l-5 5H3z"/><path d="M12 6l6-3v18l-6-3"/></svg>';
            if (n.includes('bathrobe') || n.includes('robe')) return '<svg viewBox="0 0 24 24"><path d="M8 3l4 5 4-5"/><path d="M12 8v13"/><path d="M8 3v5l-4 13h16L16 8V3"/></svg>';
            // Entertainment
            if (n.includes('tv') || n.includes('television') || n.includes('flat-screen') || n.includes('flat screen')) return '<svg viewBox="0 0 24 24"><rect x="2" y="4" width="20" height="13" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>';
            if (n.includes('streaming')) return '<svg viewBox="0 0 24 24"><polygon points="5 3 19 12 5 21"/></svg>';
            // Connectivity
            if (n.includes('wifi') || n.includes('wi-fi') || n.includes('internet') || n.includes('wireless')) return '<svg viewBox="0 0 24 24"><path d="M5 12.55a11 11 0 0 1 14.08 0"/><path d="M1.42 9a16 16 0 0 1 21.16 0"/><path d="M8.53 16.11a6 6 0 0 1 6.95 0"/><circle cx="12" cy="20" r="1"/></svg>';
            // Sleep / bedding
            if (n.includes('linen') || n.includes('bed linen')) return '<svg viewBox="0 0 24 24"><path d="M3 18v-3a8 8 0 0 1 8-8h2a8 8 0 0 1 8 8v3"/><rect x="2" y="18" width="20" height="3" rx="1"/><circle cx="8" cy="11" r="2"/></svg>';
            if (n.includes('hypoallergenic')) return '<svg viewBox="0 0 24 24"><path d="M12 2L9.5 8.5 3 10l5 4.5L6.5 21 12 17.5 17.5 21 16 14.5 21 10l-6.5-1.5z"/></svg>';
            // Room features
            if (n.includes('desk') || n.includes('workspace')) return '<svg viewBox="0 0 24 24"><rect x="3" y="8" width="18" height="3" rx="1"/><path d="M5 11v8"/><path d="M19 11v8"/></svg>';
            if (n.includes('seating') || n.includes('chair') || n.includes('sofa')) return '<svg viewBox="0 0 24 24"><path d="M5 11V7a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v4"/><rect x="3" y="11" width="18" height="6" rx="2"/><path d="M5 17v3"/><path d="M19 17v3"/></svg>';
            if (n.includes('wardrobe') || n.includes('closet')) return '<svg viewBox="0 0 24 24"><rect x="4" y="2" width="16" height="18" rx="1"/><line x1="12" y1="2" x2="12" y2="20"/><path d="M4 20h16"/><line x1="10" y1="10" x2="10" y2="13"/><line x1="14" y1="10" x2="14" y2="13"/></svg>';
            if (n.includes('safe') || n.includes('safety')) return '<svg viewBox="0 0 24 24"><rect x="3" y="5" width="18" height="14" rx="2"/><circle cx="12" cy="12" r="3"/><path d="M12 9v6"/></svg>';
            if (n.includes('socket') || n.includes('plug') || n.includes('power')) return '<svg viewBox="0 0 24 24"><path d="M9 2v6"/><path d="M15 2v6"/><path d="M7 8h10v4a5 5 0 0 1-10 0V8z"/><path d="M12 16v5"/></svg>';
            // Flooring
            if (n.includes('tile') || n.includes('marble') || n.includes('floor')) return '<svg viewBox="0 0 24 24"><rect x="3" y="3" width="8" height="8"/><rect x="13" y="3" width="8" height="8"/><rect x="3" y="13" width="8" height="8"/><rect x="13" y="13" width="8" height="8"/></svg>';
            // Kitchen / dining
            if (n.includes('kitchen') || n.includes('kitchenette')) return '<svg viewBox="0 0 24 24"><rect x="3" y="10" width="18" height="10" rx="1"/><path d="M3 14h18"/><circle cx="7" cy="12" r="0.5"/><circle cx="12" cy="12" r="0.5"/><path d="M7 4v6"/><path d="M12 4v6"/><path d="M17 6v4"/></svg>';
            if (n.includes('coffee') || n.includes('tea') || n.includes('kettle')) return '<svg viewBox="0 0 24 24"><path d="M17 8h2a2 2 0 0 1 0 4h-2"/><rect x="3" y="8" width="14" height="8" rx="1"/><path d="M6 1v3"/><path d="M10 1v3"/><path d="M14 1v3"/><line x1="3" y1="20" x2="17" y2="20"/><path d="M5 16v4"/><path d="M15 16v4"/></svg>';
            if (n.includes('fridge') || n.includes('refrigerator') || n.includes('minibar')) return '<svg viewBox="0 0 24 24"><rect x="5" y="2" width="14" height="20" rx="2"/><line x1="5" y1="10" x2="19" y2="10"/><line x1="9" y1="5" x2="9" y2="8"/><line x1="9" y1="13" x2="9" y2="16"/></svg>';
            // Laundry
            if (n.includes('washing') || n.includes('laundry')) return '<svg viewBox="0 0 24 24"><rect x="3" y="2" width="18" height="20" rx="2"/><circle cx="12" cy="13" r="5"/><circle cx="12" cy="13" r="2"/><circle cx="7" cy="5" r="1"/></svg>';
            if (n.includes('iron')) return '<svg viewBox="0 0 24 24"><path d="M3 17h18l-3-8H8L3 17z"/><path d="M8 9V5h4"/></svg>';
            if (n.includes('clothes rack') || n.includes('hanger')) return '<svg viewBox="0 0 24 24"><path d="M12 4a2 2 0 1 0 0 4"/><path d="M12 8l-9 7h18l-9-7z"/><path d="M5 15v5"/><path d="M19 15v5"/></svg>';
            // Parking / transport
            if (n.includes('parking')) return '<svg viewBox="0 0 24 24"><rect x="4" y="3" width="16" height="18" rx="2"/><path d="M9 17V7h4a3 3 0 0 1 0 6H9"/></svg>';
            // Fire / BBQ
            if (n.includes('bbq') || n.includes('firepit') || n.includes('fire pit') || n.includes('campfire')) return '<svg viewBox="0 0 24 24"><path d="M12 2c2 3 4 5.5 4 8.5a4 4 0 1 1-8 0C8 7.5 10 5 12 2z"/><path d="M5 21h14"/><path d="M8 18h8v3H8z"/></svg>';
            // Size / measurements
            if (n.includes('m²') || n.includes('sqm') || n.includes('sq ft') || n.includes('square')) return '<svg viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="1" fill="none"/><path d="M3 9h3"/><path d="M3 15h3"/><path d="M18 9h3"/><path d="M18 15h3"/><path d="M9 3v3"/><path d="M15 3v3"/><path d="M9 18v3"/><path d="M15 18v3"/></svg>';
            // Ground floor / accessibility
            if (n.includes('ground floor') || n.includes('accessible')) return '<svg viewBox="0 0 24 24"><rect x="3" y="13" width="18" height="8" rx="1"/><path d="M7 13V9l5-5 5 5v4"/></svg>';
            // Smoking
            if (n.includes('smoking') || n.includes('no smoking')) return '<svg viewBox="0 0 24 24"><rect x="1" y="14" width="16" height="4" rx="1"/><path d="M20 10V7c0-1.1-.9-2-2-2h-1"/><path d="M20 14v4"/><path d="M23 14v4"/><line x1="2" y1="22" x2="22" y2="2" stroke-width="2"/></svg>';
            // Pets
            if (n.includes('pet') || n.includes('dog')) return '<svg viewBox="0 0 24 24"><path d="M10 5a2 2 0 1 0-4 0 2 2 0 1 0 4 0z"/><path d="M18 5a2 2 0 1 0-4 0 2 2 0 1 0 4 0z"/><path d="M6 12a2 2 0 1 0-4 0 2 2 0 1 0 4 0z"/><path d="M22 12a2 2 0 1 0-4 0 2 2 0 1 0 4 0z"/><path d="M8 17c0-2.2 1.8-4 4-4s4 1.8 4 4c0 1.5-1.3 3-4 3s-4-1.5-4-3z"/></svg>';
            // Generic / fallback
            return '<svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="1.5"/></svg>';
        }

        function toggleDetails(site) {
            var panel = document.getElementById(site + '-details');
            if (!panel) return;
            var isOpen = panel.style.display !== 'none';
            panel.style.display = isOpen ? 'none' : '';
            var btn = document.querySelector('#campsite-' + site + ' .details-toggle');
            if (btn) btn.innerHTML = isOpen ? 'View details &#9662;' : 'Hide details &#9652;';
        }

        function formatTcText(text) {
            if (!text) return '';
            var html = '';
            var lines = text.split('\n');
            for (var i = 0; i < lines.length; i++) {
                var line = lines[i].trim();
                if (!line) continue;
                if (/^\d+\.\s/.test(line)) {
                    html += '<h4>' + escapeHtml(line) + '</h4>';
                } else {
                    html += '<p>' + escapeHtml(line) + '</p>';
                }
            }
            return html;
        }

        function openTcModal() {
            document.getElementById('tc-overlay').classList.add('open');
            document.body.style.overflow = 'hidden';
        }

        function closeTcModal() {
            document.getElementById('tc-overlay').classList.remove('open');
            document.body.style.overflow = '';
        }

        function applyConfig() {
            ALL_SITES.forEach(site => {
                const cfg = siteConfig[site];
                if (!cfg) return;

                var descEl = document.getElementById(site + '-desc');
                if (cfg.description && descEl) {
                    descEl.textContent = cfg.description;
                }

                var typeEl = document.getElementById(site + '-type');
                if (cfg.type && typeEl) {
                    typeEl.innerHTML = cfg.type.replace(/·/g, '&middot;');
                }

                const sym = currencySymbol();
                var priceEl = document.getElementById(site + '-price');
                if (priceEl) {
                    var isRoomSite = ROOM_SITES.includes(site);
                    var baseGuests = isRoomSite ? '1 guest' : '2 guests';
                    var initPrice = (isRoomSite && cfg.soloPrice) ? cfg.soloPrice : cfg.basePrice;
                    var nrDiscount = siteConfig.nonRefundableDiscount || 10;
                    var nrEnabled = siteConfig.nonRefundableEnabled !== false;
                    var nrPrice = Math.round(initPrice * (1 - nrDiscount / 100));
                    var flexSel0 = selectedCancellationPolicy === 'flexible' ? ' rate-selected' : '';
                    var nrSel0 = (nrEnabled && selectedCancellationPolicy === 'non-refundable') ? ' rate-selected' : '';
                    if (!nrEnabled && selectedCancellationPolicy === 'non-refundable') { selectedCancellationPolicy = 'flexible'; flexSel0 = ' rate-selected'; }
                    var nrHtml = nrEnabled
                        ? '<div class="rate-plan' + nrSel0 + '" onclick="selectPolicy(\'non-refundable\');updateAllCards()"><span class="rate-uncheck"></span><span class="rate-check"></span><span class="rate-badge rate-badge-nonrefundable">Non-refundable</span> <span class="rate-price-group"><strong>' + sym + nrPrice + '</strong> <span class="rate-per">/ night</span></span> <span class="rate-save">Save ' + nrDiscount + '%</span></div>'
                        : '';
                    priceEl.innerHTML =
                        '<div class="rate-plans">'
                        + '<div class="rate-plan' + flexSel0 + '" onclick="selectPolicy(\'flexible\');updateAllCards()"><span class="rate-uncheck"></span><span class="rate-check"></span><span class="rate-badge rate-badge-flexible">Flexible</span> <span class="rate-price-group"><strong>' + sym + initPrice + '</strong> <span class="rate-per">/ night</span></span></div>'
                        + nrHtml
                        + '</div>'
                        + '<span class="price-note">for ' + baseGuests
                        + (cfg.extraGuestFee > 0 ? ' &middot; +' + sym + cfg.extraGuestFee + ' per extra guest' : '')
                        + '</span>';
                }

                const maxG = cfg.maxGuests || 20;
                var badgeEl = document.getElementById(site + '-max-badge');
                if (badgeEl) badgeEl.textContent = 'Max ' + maxG + ' guest' + (maxG > 1 ? 's' : '');

                var msgEl = document.getElementById(site + '-guest-msg');
                if (msgEl) {
                    var label = ROOM_SITES.includes(site) ? 'room' : 'site';
                    msgEl.innerHTML = 'This ' + label + ' accommodates up to <strong>' + maxG + ' guests</strong>. Please select fewer guests.';
                }

                // Highlight tags
                var hlEl = document.getElementById(site + '-highlights');
                if (hlEl) {
                    var tags = cfg.amenities || [];
                    if (tags.length > 0) {
                        hlEl.innerHTML = tags.map(function(t) {
                            return '<span class="highlight-tag">' + tagIcon(t) + escapeHtml(t) + '</span>';
                        }).join('');
                    } else {
                        hlEl.innerHTML = '';
                    }
                }

                // Details meta (size, beds, smoking)
                var metaEl = document.getElementById(site + '-details-meta');
                if (metaEl) {
                    var metaParts = [];
                    if (cfg.size) metaParts.push('<span><strong>Size</strong> ' + escapeHtml(cfg.size) + '</span>');
                    if (cfg.beds) metaParts.push('<span><strong>Beds</strong> ' + escapeHtml(cfg.beds) + '</span>');
                    if (cfg.smoking) {
                        var smokingLabel = cfg.smoking === 'no' ? 'No smoking' : cfg.smoking === 'outdoors' ? 'Outdoors only' : 'Smoking allowed';
                        metaParts.push('<span><strong>Smoking</strong> ' + smokingLabel + '</span>');
                    }
                    metaEl.innerHTML = metaParts.join('');
                }

                // Amenity categories
                var catsEl = document.getElementById(site + '-details-cats');
                if (catsEl) {
                    var cats = cfg.amenityCategories || [];
                    if (cats.length > 0) {
                        catsEl.innerHTML = cats.map(function(cat) {
                            var itemsHtml = (cat.items || []).map(function(item) {
                                return '<span>' + tagIcon(item) + escapeHtml(item) + '</span>';
                            }).join('');
                            return '<div class="details-category">' +
                                '<h4>' + escapeHtml(cat.name) + '</h4>' +
                                '<div class="details-cat-items">' + itemsHtml + '</div>' +
                                '</div>';
                        }).join('');
                    } else {
                        catsEl.innerHTML = '';
                    }
                }

                // Hide details toggle if no details data
                var toggleBtn = document.querySelector('#campsite-' + site + ' .details-toggle');
                var hasDetails = (cfg.size || cfg.beds || cfg.smoking || (cfg.amenityCategories && cfg.amenityCategories.length > 0));
                if (toggleBtn) toggleBtn.style.display = hasDetails ? '' : 'none';
            });

            const maxGuests = Math.max(
                ...ALL_SITES.map(s => siteConfig[s]?.maxGuests || 20)
            );
            const select = document.getElementById('search-guests');
            const currentVal = select.value;
            select.innerHTML = '';
            for (let i = 1; i <= maxGuests; i++) {
                const opt = document.createElement('option');
                opt.value = i;
                opt.textContent = i + (i === 1 ? ' guest' : ' guests');
                if (i === parseInt(currentVal)) opt.selected = true;
                select.appendChild(opt);
            }
            if (!select.value) {
                select.value = '2';
            }

            if (siteConfig.rules && siteConfig.rules.length > 0) {
                const rulesList = document.getElementById('rules-list');
                rulesList.innerHTML = siteConfig.rules.map(r => '<li>' + r + '</li>').join('');
            }

            initAddons();

            updateGuestAvailability();

            // Populate T&C modal
            var tcBody = document.getElementById('tc-modal-body');
            if (tcBody) {
                var tcText = siteConfig.termsAndConditions || DEFAULT_CONFIG.termsAndConditions || '';
                tcBody.innerHTML = formatTcText(tcText);
            }
        }

        // --- Per-night price display ---
        function updatePerNightPrice(site) {
            const cfg = siteConfig[site];
            if (!cfg) return;
            const sym = currencySymbol();
            const guestCount = getSearchGuests();
            const extraGuests = Math.max(0, guestCount - 2);
            const effectiveBase = (guestCount === 1 && cfg.soloPrice) ? cfg.soloPrice : cfg.basePrice;
            const perNight = effectiveBase + (extraGuests * cfg.extraGuestFee);
            const nrDiscount = siteConfig.nonRefundableDiscount || 10;
            const nrPerNight = Math.round(perNight * (1 - nrDiscount / 100));

            let noteHtml = '<span class="price-note">for ' + guestCount + ' guest' + (guestCount > 1 ? 's' : '');
            if (guestCount === 1 && cfg.soloPrice) {
                noteHtml += ' &middot; solo rate';
            } else if (extraGuests > 0) {
                noteHtml += ' &middot; base ' + sym + cfg.basePrice + ' + ' + extraGuests + ' extra x ' + sym + cfg.extraGuestFee;
            }
            if (isRoom(site)) {
                const wkPct = siteConfig.weekendMarkup || 0;
                const holPct = siteConfig.holidayMarkup || 0;
                if (wkPct > 0 || holPct > 0) {
                    noteHtml += ' &middot; <span style="color:var(--color-stone)">weekend/holiday rates apply</span>';
                }
            }
            noteHtml += '</span>';

            var nrEnabled = siteConfig.nonRefundableEnabled !== false;
            if (!nrEnabled && selectedCancellationPolicy === 'non-refundable') { selectedCancellationPolicy = 'flexible'; }
            var flexSel = selectedCancellationPolicy === 'flexible' ? ' rate-selected' : '';
            var nrSel = (nrEnabled && selectedCancellationPolicy === 'non-refundable') ? ' rate-selected' : '';

            let html = '<div class="rate-plans">';
            html += '<div class="rate-plan' + flexSel + '" onclick="selectPolicy(\'flexible\');updateAllCards()"><span class="rate-uncheck"></span><span class="rate-check"></span><span class="rate-badge rate-badge-flexible">Flexible</span> <span class="rate-price-group"><strong>' + sym + perNight + '</strong> <span class="rate-per">/ night</span></span></div>';
            if (nrEnabled) {
                html += '<div class="rate-plan' + nrSel + '" onclick="selectPolicy(\'non-refundable\');updateAllCards()"><span class="rate-uncheck"></span><span class="rate-check"></span><span class="rate-badge rate-badge-nonrefundable">Non-refundable</span> <span class="rate-price-group"><strong>' + sym + nrPerNight + '</strong> <span class="rate-per">/ night</span></span> <span class="rate-save">Save ' + nrDiscount + '%</span></div>';
            }
            html += '</div>';
            html += noteHtml;

            document.getElementById(site + '-price').innerHTML = html;
        }

        // --- Price breakdown (on campsite card) ---
        function updatePriceBreakdown(site) {
            const checkin = getSearchDate('checkin');
            const checkout = getSearchDate('checkout');
            const guestCount = getSearchGuests();
            const breakdownEl = document.getElementById(site + '-breakdown');

            if (!checkin || !checkout || checkout <= checkin) {
                breakdownEl.style.display = 'none';
                return;
            }

            const cfg = siteConfig[site];
            if (!cfg) return;

            const breakdown = calculateNightlyBreakdown(site, checkin, checkout);
            if (breakdown.nights <= 0) {
                breakdownEl.style.display = 'none';
                return;
            }

            const sym = currencySymbol();
            const baseCost = breakdown.totalBase;
            const isSolo = guestCount === 1 && cfg.soloPrice;
            const extraGuests = isSolo ? 0 : Math.max(0, guestCount - 2);
            const extraCost = extraGuests * cfg.extraGuestFee * breakdown.nights;
            const total = baseCost + extraCost;

            var effectiveBase = getBaseRate(site);
            let html = '';
            if (isRoom(site) && (breakdown.weekendNights > 0 || breakdown.holidayNights > 0)) {
                // Show per-rate-type breakdown for rooms
                if (breakdown.standardNights > 0) {
                    html += '<div class="price-line"><span>' + breakdown.standardNights + ' standard night' + (breakdown.standardNights > 1 ? 's' : '') + ' x ' + sym + effectiveBase + '</span><span>' + sym + (breakdown.standardNights * effectiveBase).toFixed(2) + '</span></div>';
                }
                if (breakdown.weekendNights > 0) {
                    var wkRate = Math.round(effectiveBase * (1 + (siteConfig.weekendMarkup || 0) / 100));
                    html += '<div class="price-line"><span>' + breakdown.weekendNights + ' weekend night' + (breakdown.weekendNights > 1 ? 's' : '') + ' x ' + sym + wkRate + '</span><span>' + sym + (breakdown.weekendNights * wkRate).toFixed(2) + '</span></div>';
                }
                if (breakdown.holidayNights > 0) {
                    var holRate = Math.round(effectiveBase * (1 + (siteConfig.holidayMarkup || 0) / 100));
                    html += '<div class="price-line"><span>' + breakdown.holidayNights + ' holiday night' + (breakdown.holidayNights > 1 ? 's' : '') + ' x ' + sym + holRate + '</span><span>' + sym + (breakdown.holidayNights * holRate).toFixed(2) + '</span></div>';
                }
            } else {
                html += '<div class="price-line"><span>' + breakdown.nights + ' night' + (breakdown.nights > 1 ? 's' : '') + ' x ' + sym + effectiveBase + '</span><span>' + sym + baseCost.toFixed(2) + '</span></div>';
            }

            if (extraCost > 0) {
                html += '<div class="price-line"><span>' + extraGuests + ' extra guest' + (extraGuests > 1 ? 's' : '') + '</span><span>' + sym + extraCost.toFixed(2) + '</span></div>';
            }

            var cardTotal = total;
            if (selectedCancellationPolicy === 'non-refundable') {
                var nrPct = siteConfig.nonRefundableDiscount || 10;
                var nrSaving = total * (nrPct / 100);
                cardTotal = total - nrSaving;
                html += '<div class="price-line" style="color:var(--color-forest)"><span>Non-refundable discount (' + nrPct + '%)</span><span>-' + sym + nrSaving.toFixed(2) + '</span></div>';
            }

            html += '<div class="price-line total"><span>Total</span><span>' + sym + cardTotal.toFixed(2) + '</span></div>';

            breakdownEl.innerHTML = html;
            breakdownEl.style.display = 'block';
        }

        // --- Date helpers ---
        function getDatesInRange(start, end) {
            const dates = [];
            const current = new Date(start);
            const endDate = new Date(end);
            while (current < endDate) {
                dates.push(current.toISOString().split('T')[0]);
                current.setDate(current.getDate() + 1);
            }
            return dates;
        }

        function hasConflict(site, checkinVal, checkoutVal) {
            if (!checkinVal || !checkoutVal) return false;
            const requested = getDatesInRange(checkinVal, checkoutVal);
            return requested.some(d => bookedDates[site].includes(d));
        }

        function updateWarning(site) {
            const checkin = getSearchDate('checkin');
            const checkout = getSearchDate('checkout');
            const warning = document.getElementById(site + '-warning');
            const conflict = hasConflict(site, checkin, checkout);
            warning.classList.toggle('show', conflict);
            return conflict;
        }

        // --- Fetch availability from Cloudflare Worker ---
        async function fetchAvailability(site) {
            try {
                const cacheBust = '_t=' + Date.now();
                const [calRes, blockedRes] = await Promise.all([
                    fetch(WORKER_URL + '?site=' + site + '&' + cacheBust, { cache: 'no-store' }).then(r => r.ok ? r.json() : { bookedDates: [] }).catch(() => ({ bookedDates: [] })),
                    fetch(WORKER_URL + '/blocked-dates/' + site + '?' + cacheBust, { cache: 'no-store' }).then(r => r.ok ? r.json() : { blockedDates: [] }).catch(() => ({ blockedDates: [] })),
                ]);

                const hipcampDates = calRes.bookedDates || [];
                const manualDates = blockedRes.blockedDates || [];
                bookedDates[site] = [...new Set([...hipcampDates, ...manualDates])].sort();
            } catch (err) {
                console.warn('Availability fetch failed for ' + site + ':', err);
            }
        }

        function refreshAllAvailability() {
            ALL_SITES.forEach(s => fetchAvailability(s));
            setTimeout(function() {
                var open = document.querySelector('.dp-dropdown.open');
                if (open) {
                    var field = open.id.replace('dp-search-', '');
                    renderDatePicker(field);
                }
                updateAllCards();
            }, 1500);
        }

        // Refresh availability when user returns to the page (e.g. after Stripe payment, or tab switch)
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) refreshAllAvailability();
        });

        // --- Custom date picker ---
        const dpState = {
            month: new Date().getMonth(),
            year: new Date().getFullYear(),
        };

        function initDatePickers() {
            ['checkin', 'checkout'].forEach(field => {
                const input = document.getElementById('search-' + field);
                input.dataset.date = '';
                input.classList.add('dp-input');

                const wrapper = document.createElement('div');
                wrapper.className = 'date-picker-wrapper';
                input.parentNode.insertBefore(wrapper, input);
                wrapper.appendChild(input);

                const dropdown = document.createElement('div');
                dropdown.className = 'dp-dropdown';
                dropdown.id = 'dp-search-' + field;
                wrapper.appendChild(dropdown);

                input.addEventListener('click', (e) => {
                    e.stopPropagation();
                    openDatePicker(field);
                });
            });

            document.addEventListener('click', (e) => {
                if (!e.target.closest('.date-picker-wrapper')) {
                    closeAllDatePickers();
                }
            });
        }

        function openDatePicker(field) {
            closeAllDatePickers();

            const currentVal = document.getElementById('search-' + field).dataset.date;
            if (currentVal) {
                const d = new Date(currentVal);
                dpState.month = d.getMonth();
                dpState.year = d.getFullYear();
            } else {
                dpState.month = new Date().getMonth();
                dpState.year = new Date().getFullYear();
            }

            renderDatePicker(field);
            document.getElementById('dp-search-' + field).classList.add('open');
        }

        function closeAllDatePickers() {
            document.querySelectorAll('.dp-dropdown').forEach(d => d.classList.remove('open'));
        }

        function renderDatePicker(field) {
            const dropdown = document.getElementById('dp-search-' + field);
            const year = dpState.year;
            const month = dpState.month;

            const monthNames = ['January','February','March','April','May','June','July','August','September','October','November','December'];
            const todayStr = new Date().toISOString().split('T')[0];
            const checkinVal = getSearchDate('checkin');
            const checkoutVal = getSearchDate('checkout');

            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const startDay = (firstDay + 6) % 7;

            let html = '<div class="dp-nav">';
            html += '<button type="button" class="dp-arrow" onclick="event.stopPropagation();dpNav(\'' + field + '\',-1)">&lsaquo;</button>';
            html += '<span class="dp-month-label">' + monthNames[month] + ' ' + year + '</span>';
            html += '<button type="button" class="dp-arrow" onclick="event.stopPropagation();dpNav(\'' + field + '\',1)">&rsaquo;</button>';
            html += '</div>';

            html += '<div class="dp-grid">';
            ['Mo','Tu','We','Th','Fr','Sa','Su'].forEach(d => {
                html += '<div class="dp-header">' + d + '</div>';
            });

            for (let i = 0; i < startDay; i++) {
                html += '<div class="dp-day dp-empty"></div>';
            }

            for (let d = 1; d <= daysInMonth; d++) {
                const dateStr = year + '-' + String(month + 1).padStart(2, '0') + '-' + String(d).padStart(2, '0');
                const isPast = dateStr < todayStr;
                const activeSites = activeCategory === 'campsites' ? CAMPSITE_SITES : ROOM_SITES;
                const blockedCount = activeSites.filter(s => bookedDates[s].includes(dateStr)).length;
                const blockedAll = blockedCount === activeSites.length;
                const blockedSome = blockedCount > 0 && !blockedAll;
                const isToday = dateStr === todayStr;
                const isSelected = dateStr === checkinVal || dateStr === checkoutVal;

                let isDisabled = isPast;
                if (field === 'checkout' && checkinVal && dateStr <= checkinVal) {
                    isDisabled = true;
                }

                const inRange = checkinVal && checkoutVal && dateStr > checkinVal && dateStr < checkoutVal;

                let cls = 'dp-day';
                if (isDisabled) cls += ' dp-past';
                if (blockedAll && !isPast) cls += ' dp-blocked';
                else if (blockedSome && !isPast) cls += ' dp-limited';
                if (isToday && !isDisabled) cls += ' dp-today';
                if (isSelected) cls += ' dp-selected';
                if (inRange && !blockedAll) cls += ' dp-in-range';

                const canClick = !isDisabled && !blockedAll;
                const handler = canClick ? ' onclick="event.stopPropagation();dpSelect(\'' + field + '\',\'' + dateStr + '\')"' : '';

                html += '<div class="' + cls + '"' + handler + '>' + d + '</div>';
            }

            html += '</div>';

            html += '<div class="dp-legend">';
            html += '<span class="dp-legend-item"><span class="dp-legend-dot" style="background:#c0392b"></span> Fully booked</span>';
            html += '<span class="dp-legend-item"><span class="dp-legend-dot" style="background:#d4a017"></span> Limited</span>';
            html += '</div>';

            html += '<div class="dp-footer">';
            html += '<a onclick="event.stopPropagation();dpClear(\'' + field + '\')">Clear</a>';
            html += '<a onclick="event.stopPropagation();dpToday(\'' + field + '\')">Today</a>';
            html += '</div>';

            dropdown.innerHTML = html;
        }

        function dpNav(field, dir) {
            dpState.month += dir;
            if (dpState.month > 11) { dpState.month = 0; dpState.year++; }
            if (dpState.month < 0) { dpState.month = 11; dpState.year--; }
            renderDatePicker(field);
        }

        function dpSelect(field, dateStr) {
            setSearchDate(field, dateStr);

            if (field === 'checkin') {
                const checkoutVal = getSearchDate('checkout');
                if (!checkoutVal || checkoutVal <= dateStr) {
                    const next = new Date(dateStr);
                    next.setDate(next.getDate() + 1);
                    setSearchDate('checkout', next.toISOString().split('T')[0]);
                }
                closeAllDatePickers();
                setTimeout(() => openDatePicker('checkout'), 100);
            } else {
                closeAllDatePickers();
            }

            updateAllCards();
        }

        function dpClear(field) {
            setSearchDate(field, '');
            closeAllDatePickers();
            updateAllCards();
        }

        function dpToday(field) {
            const todayStr = new Date().toISOString().split('T')[0];
            const todayActiveSites = activeCategory === 'campsites' ? CAMPSITE_SITES : ROOM_SITES;
            const blockedAll = todayActiveSites.every(s => bookedDates[s].includes(todayStr));
            if (!blockedAll) {
                dpSelect(field, todayStr);
            }
        }

        // --- Wizard navigation ---
        function goToStep(step) {
            if (step === 5 && currentStep === 4) {
                const name = document.getElementById('guest-name').value.trim();
                const email = document.getElementById('guest-email').value.trim();
                const phone = document.getElementById('guest-phone').value.trim();

                if (!name || !email || !phone) {
                    alert('Please fill in all required fields.');
                    return;
                }

                if (!email.includes('@')) {
                    alert('Please enter a valid email address.');
                    return;
                }
            }

            currentStep = step;
            updateProgress(step);
            updateStepVisibility();
            updateSummaries();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateProgress(step) {
            document.querySelectorAll('.progress-step').forEach(el => {
                const s = parseInt(el.dataset.step);
                el.classList.remove('active', 'completed');
                if (s < step) {
                    el.classList.add('completed');
                } else if (s === step) {
                    el.classList.add('active');
                }
            });

            document.querySelectorAll('.progress-line').forEach((line, i) => {
                line.classList.toggle('completed', i < step - 1);
            });
        }

        function updateStepVisibility() {
            document.querySelectorAll('.wizard-step').forEach(el => {
                el.classList.remove('active');
            });

            // Only show camping experience section for campsites on initial view (steps 1-2)
            var campExp = document.querySelector('.camp-experience');
            if (campExp) campExp.style.display = (currentStep <= 2 && activeCategory === 'campsites') ? '' : 'none';

            // Show/hide category toggle only on initial steps
            var catToggle = document.querySelector('.category-toggle');
            if (catToggle) catToggle.style.display = currentStep <= 2 ? '' : 'none';

            // Hide search bar after site selection
            var searchBar = document.querySelector('.search-bar');
            if (searchBar) searchBar.style.display = currentStep <= 2 ? '' : 'none';

            if (currentStep === 2) {
                document.getElementById('step-select').classList.add('active');
            } else if (currentStep === 3) {
                document.getElementById('step-addons').classList.add('active');
            } else if (currentStep === 4) {
                document.getElementById('step-details').classList.add('active');
            } else if (currentStep === 5) {
                document.getElementById('step-review').classList.add('active');
                populateReview();
            }
        }

        // --- Select site ---
        function selectSite(site) {
            selectedSite = site;
            // Re-initialize add-ons for the correct category (room vs campsite)
            initAddons();

            document.getElementById('addons-site-name').textContent = site.toUpperCase();
            renderAddonsUI();
            goToStep(3);
        }

        // --- Add-ons ---
        function initAddons() {
            var isRoomSite = selectedSite && ROOM_SITES.includes(selectedSite);
            var addonDefs = isRoomSite
                ? (siteConfig.roomAddons || [])
                : (siteConfig.campsiteAddons || []);
            // Fall back to legacy bookingAddons if new keys not set
            if (addonDefs.length === 0 && siteConfig.bookingAddons) {
                addonDefs = siteConfig.bookingAddons;
            }
            addons = {};
            addonDefs.forEach(function(a) {
                if (a.enabled !== false) {
                    addons[a.id] = { qty: 0, price: a.price || 0, name: a.name, description: a.description || '' };
                }
            });
        }

        function renderAddonsUI() {
            var container = document.getElementById('addons-list');
            var sym = currencySymbol();
            var html = '';
            for (var key in addons) {
                var a = addons[key];
                html += '<div class="addon-card">';
                html += '<div class="addon-header">';
                html += '<div class="addon-name">' + a.name + '</div>';
                html += '<div class="addon-price">' + sym + a.price + '</div>';
                html += '</div>';
                if (a.description) html += '<div class="addon-desc">' + a.description + '</div>';
                html += '<div class="addon-qty">';
                html += '<label>Quantity:</label>';
                html += '<div class="qty-control">';
                html += '<button type="button" class="qty-btn" onclick="updateAddonQty(\'' + key + '\', -1)">−</button>';
                html += '<span class="qty-value" id="' + key + '-qty">' + a.qty + '</span>';
                html += '<button type="button" class="qty-btn" onclick="updateAddonQty(\'' + key + '\', 1)">+</button>';
                html += '</div></div></div>';
            }
            if (!html) html = '<p style="color:var(--color-stone);font-size:0.9rem">No add-ons available.</p>';
            container.innerHTML = html;
        }

        function updateAddonQty(addon, delta) {
            var maxQty = 10;
            var current = addons[addon].qty;
            var newQty = Math.max(0, Math.min(maxQty, current + delta));
            addons[addon].qty = newQty;
            document.getElementById(addon + '-qty').textContent = newQty;
            updateSummaries();
        }

        // --- Promo codes ---
        function applyPromo() {
            const input = document.getElementById('guest-promo');
            const msgEl = document.getElementById('promo-msg');
            const code = input.value.trim().toUpperCase();

            if (!code) {
                appliedPromo = null;
                msgEl.textContent = '';
                msgEl.className = 'promo-msg';
                updateSummaries();
                return;
            }

            const promos = siteConfig.promoCodes || {};
            if (promos[code]) {
                appliedPromo = { code, ...promos[code] };
                const label = promos[code].type === 'percent'
                    ? promos[code].value + '% off'
                    : currencySymbol() + promos[code].value + ' off';
                msgEl.textContent = 'Code applied: ' + label;
                msgEl.className = 'promo-msg valid';
            } else {
                appliedPromo = null;
                msgEl.textContent = 'Invalid promo code';
                msgEl.className = 'promo-msg invalid';
            }

            updateSummaries();
        }

        // --- Cancellation policy ---
        function selectPolicy(policy) {
            selectedCancellationPolicy = policy;
            updateSummaries();
        }


        // --- Calculate totals ---
        function calculateTotals() {
            if (!selectedSite) return null;

            const checkin = getSearchDate('checkin');
            const checkout = getSearchDate('checkout');
            const guestCount = getSearchGuests();

            if (!checkin || !checkout) return null;

            const cfg = siteConfig[selectedSite];
            if (!cfg) return null;

            const breakdown = calculateNightlyBreakdown(selectedSite, checkin, checkout);
            if (breakdown.nights <= 0) return null;

            const sym = currencySymbol();
            const baseCost = breakdown.totalBase;
            const isSolo = guestCount === 1 && cfg.soloPrice;
            const extraGuests = isSolo ? 0 : Math.max(0, guestCount - 2);
            const extraCost = extraGuests * cfg.extraGuestFee * breakdown.nights;

            let addonsCost = 0;
            for (const [key, addon] of Object.entries(addons)) {
                addonsCost += addon.qty * addon.price;
            }

            let subtotal = baseCost + extraCost + addonsCost;
            let discount = 0;

            if (appliedPromo) {
                if (appliedPromo.type === 'percent') {
                    discount = subtotal * (appliedPromo.value / 100);
                } else {
                    discount = Math.min(appliedPromo.value, subtotal);
                }
            }

            // Non-refundable discount
            let nonRefundableDiscount = 0;
            if (selectedCancellationPolicy === 'non-refundable') {
                const pct = siteConfig.nonRefundableDiscount || 10;
                nonRefundableDiscount = (subtotal - discount) * (pct / 100);
            }

            const total = subtotal - discount - nonRefundableDiscount;

            return {
                nights: breakdown.nights,
                baseCost,
                extraGuests,
                extraCost,
                addonsCost,
                subtotal,
                discount,
                nonRefundableDiscount,
                total,
                sym,
                breakdown
            };
        }

        // --- Update summaries ---
        function buildAccomLines(sym, cfg, breakdown) {
            let html = '';
            var effectiveBase = getBaseRate(selectedSite);
            if (isRoom(selectedSite) && (breakdown.weekendNights > 0 || breakdown.holidayNights > 0)) {
                if (breakdown.standardNights > 0) {
                    html += '<div class="summary-line"><span>' + breakdown.standardNights + ' standard night' + (breakdown.standardNights > 1 ? 's' : '') + ' x ' + sym + effectiveBase + '</span><span>' + sym + (breakdown.standardNights * effectiveBase).toFixed(2) + '</span></div>';
                }
                if (breakdown.weekendNights > 0) {
                    var wkRate = Math.round(effectiveBase * (1 + (siteConfig.weekendMarkup || 0) / 100));
                    html += '<div class="summary-line"><span>' + breakdown.weekendNights + ' weekend night' + (breakdown.weekendNights > 1 ? 's' : '') + ' x ' + sym + wkRate + '</span><span>' + sym + (breakdown.weekendNights * wkRate).toFixed(2) + '</span></div>';
                }
                if (breakdown.holidayNights > 0) {
                    var holRate = Math.round(effectiveBase * (1 + (siteConfig.holidayMarkup || 0) / 100));
                    html += '<div class="summary-line"><span>' + breakdown.holidayNights + ' holiday night' + (breakdown.holidayNights > 1 ? 's' : '') + ' x ' + sym + holRate + '</span><span>' + sym + (breakdown.holidayNights * holRate).toFixed(2) + '</span></div>';
                }
            } else {
                html += '<div class="summary-line"><span>' + breakdown.nights + ' night' + (breakdown.nights > 1 ? 's' : '') + ' x ' + sym + effectiveBase + '</span><span>' + sym + breakdown.totalBase.toFixed(2) + '</span></div>';
            }
            return html;
        }

        function updateSummaries() {
            const totals = calculateTotals();
            if (!totals) return;

            const { nights, baseCost, extraGuests, extraCost, addonsCost, subtotal, discount, nonRefundableDiscount, total, sym, breakdown } = totals;
            const cfg = siteConfig[selectedSite];

            let addonsHtml = buildAccomLines(sym, cfg, breakdown);

            if (extraCost > 0) {
                addonsHtml += '<div class="summary-line"><span>' + extraGuests + ' extra guest' + (extraGuests > 1 ? 's' : '') + ' x ' + sym + cfg.extraGuestFee + ' x ' + nights + ' nights</span><span>' + sym + extraCost.toFixed(2) + '</span></div>';
            }

            for (var ak in addons) { if (addons[ak].qty > 0) {
                addonsHtml += '<div class="summary-line"><span>' + addons[ak].name + ' x ' + addons[ak].qty + '</span><span>' + sym + (addons[ak].qty * addons[ak].price).toFixed(2) + '</span></div>';
            }}

            if (nonRefundableDiscount > 0) {
                addonsHtml += '<div class="summary-line discount"><span>Non-refundable discount (' + (siteConfig.nonRefundableDiscount || 10) + '%)</span><span>-' + sym + nonRefundableDiscount.toFixed(2) + '</span></div>';
            }

            addonsHtml += '<div class="summary-line total"><span>Total</span><span>' + sym + total.toFixed(2) + '</span></div>';

            document.getElementById('addons-summary-content').innerHTML = addonsHtml;

            let detailsHtml = buildAccomLines(sym, cfg, breakdown);

            if (extraCost > 0) {
                detailsHtml += '<div class="summary-line"><span>Extra guests (' + extraGuests + ')</span><span>' + sym + extraCost.toFixed(2) + '</span></div>';
            }

            for (var dk in addons) { if (addons[dk].qty > 0) {
                detailsHtml += '<div class="summary-line"><span>' + addons[dk].name + ' x ' + addons[dk].qty + '</span><span>' + sym + (addons[dk].qty * addons[dk].price).toFixed(2) + '</span></div>';
            }}

            if (discount > 0) {
                detailsHtml += '<div class="summary-line discount"><span>Promo: ' + appliedPromo.code + '</span><span>-' + sym + discount.toFixed(2) + '</span></div>';
            }

            if (nonRefundableDiscount > 0) {
                detailsHtml += '<div class="summary-line discount"><span>Non-refundable discount (' + (siteConfig.nonRefundableDiscount || 10) + '%)</span><span>-' + sym + nonRefundableDiscount.toFixed(2) + '</span></div>';
            }

            detailsHtml += '<div class="summary-line total"><span>Total</span><span>' + sym + total.toFixed(2) + '</span></div>';

            // Show cancellation policy note
            var policyNote = selectedCancellationPolicy === 'non-refundable'
                ? 'Non-refundable — no cancellations or changes'
                : 'Free cancellation up to ' + (siteConfig.cancellationDays || 14) + ' days before check-in';
            detailsHtml += '<div class="summary-line" style="margin-top:0.5rem;font-size:0.8rem;color:var(--color-stone)"><span>' + policyNote + '</span></div>';

            document.getElementById('details-summary-content').innerHTML = detailsHtml;
        }

        // --- Populate review page ---
        function populateReview() {
            const checkin = getSearchDate('checkin');
            const checkout = getSearchDate('checkout');
            const guestCount = getSearchGuests();

            function formatDate(isoDate) {
                const [y, m, d] = isoDate.split('-');
                const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                return d + ' ' + months[parseInt(m) - 1] + ' ' + y;
            }

            document.getElementById('review-site').textContent = selectedSite.toUpperCase();
            document.getElementById('review-checkin').textContent = formatDate(checkin);
            document.getElementById('review-checkout').textContent = formatDate(checkout);
            document.getElementById('review-guests').textContent = guestCount + ' guest' + (guestCount > 1 ? 's' : '');

            document.getElementById('review-name').textContent = document.getElementById('guest-name').value;
            document.getElementById('review-email').textContent = document.getElementById('guest-email').value;
            document.getElementById('review-phone').textContent = document.getElementById('guest-phone').value;

            const totals = calculateTotals();
            if (!totals) return;

            const { nights, baseCost, extraGuests, extraCost, discount, nonRefundableDiscount, total, sym, breakdown } = totals;
            const cfg = siteConfig[selectedSite];

            let breakdownHtml = buildAccomLines(sym, cfg, breakdown);

            if (extraCost > 0) {
                breakdownHtml += '<div class="summary-line"><span>Extra guests (' + extraGuests + ')</span><span>' + sym + extraCost.toFixed(2) + '</span></div>';
            }

            for (var rk in addons) { if (addons[rk].qty > 0) {
                breakdownHtml += '<div class="summary-line"><span>' + addons[rk].name + ' x ' + addons[rk].qty + '</span><span>' + sym + (addons[rk].qty * addons[rk].price).toFixed(2) + '</span></div>';
            }}

            if (discount > 0) {
                breakdownHtml += '<div class="summary-line discount"><span>Promo: ' + appliedPromo.code + '</span><span>-' + sym + discount.toFixed(2) + '</span></div>';
            }

            if (nonRefundableDiscount > 0) {
                breakdownHtml += '<div class="summary-line discount"><span>Non-refundable discount (' + (siteConfig.nonRefundableDiscount || 10) + '%)</span><span>-' + sym + nonRefundableDiscount.toFixed(2) + '</span></div>';
            }

            breakdownHtml += '<div class="summary-line total"><span>Total</span><span>' + sym + total.toFixed(2) + '</span></div>';

            // Cancellation policy
            var policyLabel = selectedCancellationPolicy === 'non-refundable'
                ? 'Non-refundable'
                : 'Free cancellation until ' + formatDate(getCancellationCutoff(checkin));
            breakdownHtml += '<div class="summary-line" style="margin-top:0.5rem;font-size:0.8rem;color:var(--color-stone)"><span>Cancellation: ' + policyLabel + '</span></div>';

            document.getElementById('review-breakdown').innerHTML = breakdownHtml;
        }

        function getCancellationCutoff(checkinStr) {
            var d = new Date(checkinStr + 'T12:00:00');
            d.setDate(d.getDate() - (siteConfig.cancellationDays || 14));
            var y = d.getFullYear();
            var m = String(d.getMonth() + 1).padStart(2, '0');
            var dd = String(d.getDate()).padStart(2, '0');
            return y + '-' + m + '-' + dd;
        }

        // --- Submit booking ---
        async function submitBooking() {
            const btn = document.getElementById('btn-book');
            // Check T&C agreement
            var tcCheckbox = document.getElementById('tc-agree');
            var tcError = document.getElementById('tc-error');
            if (tcCheckbox && !tcCheckbox.checked) {
                if (tcError) tcError.style.display = 'block';
                tcCheckbox.focus();
                return;
            }
            if (tcError) tcError.style.display = 'none';

            const checkin = getSearchDate('checkin');
            const checkout = getSearchDate('checkout');
            const guestCount = getSearchGuests();

            const totals = calculateTotals();
            if (!totals) {
                alert('Error calculating totals. Please try again.');
                return;
            }

            btn.disabled = true;
            btn.textContent = 'Processing...';

            try {
                const res = await fetch(WORKER_URL + '/bookings', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        site: selectedSite,
                        checkin,
                        checkout,
                        guests: guestCount,
                        name: document.getElementById('guest-name').value,
                        email: document.getElementById('guest-email').value,
                        phone: document.getElementById('guest-phone').value,
                        nights: totals.nights,
                        baseCost: totals.baseCost,
                        extraCost: totals.extraCost,
                        addons: Object.fromEntries(Object.entries(addons).filter(function(e) { return e[1].qty > 0; }).map(function(e) { return [e[0], { qty: e[1].qty, name: e[1].name, price: e[1].price }]; })),
                        addonsCost: totals.addonsCost,
                        promoCode: appliedPromo ? appliedPromo.code : '',
                        discount: totals.discount + (totals.nonRefundableDiscount || 0),
                        total: totals.total,
                        currency: siteConfig.currency || 'AUD',
                        cancellationPolicy: selectedCancellationPolicy,
                    }),
                });

                const result = await res.json();
                if (result.success) {
                    if (result.checkout_url) {
                        btn.textContent = 'Redirecting to payment...';
                        window.location.href = result.checkout_url;
                    } else {
                        alert('Booking request submitted! We\'ll be in touch shortly.');
                        window.location.reload();
                    }
                } else {
                    btn.disabled = false;
                    btn.textContent = 'Book & Pay';
                    alert('Could not submit booking: ' + (result.error || 'Please try again.'));
                }
            } catch (err) {
                btn.disabled = false;
                btn.textContent = 'Book & Pay';
                alert('Connection error. Please try again.');
            }
        }

        // --- Init ---
        initDatePickers();
        fetchConfig();
        ALL_SITES.forEach(s => fetchAvailability(s));
    </script>
    <script>
    function toggleMenu() {
        document.querySelector('.menu-btn').classList.toggle('open');
        document.querySelector('.menu-overlay').classList.toggle('open');
        document.querySelector('.menu-panel').classList.toggle('open');
    }

    function scrollToBooking() {
        var target = document.querySelector('.progress-bar');
        if (!target) return;
        var y = target.getBoundingClientRect().top + window.pageYOffset - 20;
        window.scrollTo({ top: y, behavior: 'smooth' });
        // Brief pulse on the search bar to draw attention
        setTimeout(function() {
            var bar = document.querySelector('.search-bar-inner');
            if (bar) {
                bar.style.transition = 'box-shadow 0.4s ease';
                bar.style.boxShadow = '0 0 0 3px rgba(44,62,45,0.15)';
                setTimeout(function() { bar.style.boxShadow = 'none'; }, 1200);
            }
        }, 600);
    }
    </script>
</body>
</html>
